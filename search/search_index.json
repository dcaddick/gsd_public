{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"CondAccess/","title":"2. Conditional Access (CA)","text":""},{"location":"CondAccess/#ways-of-working","title":"Ways of working","text":"<p>First decision point - how are we going to do this? Questions to help you determine this are:</p> <ol> <li>Is it small or a large Tenancy?</li> <li>Do we want to avoid CAB approval process for a PoC?</li> <li>Need it done right now to address a strategic problem?</li> <li>Do we want to go fast, or take our time?</li> <li>If you are a Partner or MSSP please choose the \"As-Code\" method</li> </ol> <p>Result:</p> <ul> <li>Fast and quick - start with telemetry below and do it on the fly using the 14 default Policies in ReportOnly Mode, iterate from there...     View 14 x CA Policy Templates</li> <li>Larger implmentations - please take the time to review the process below to enable via \"CA-as-Code\" as the ROI is well worth it - especially if doing it for more than one customer or tenant </li> </ul>"},{"location":"CondAccess/#enable-telemetry","title":"Enable Telemetry","text":"<p>NOTE: please be aware there is no inherent \"BLOCK\" by default</p> <p>You need to make sure you are BLOCKING by default unless explicitly allowing access - walk thru the 14 default Policies to better understand this. To make sure that you are fully covered please use this\u00a0PowerBI based tool https://github.com/AzureAD/AzureADAssessment Confirm your maturity based on this Tool <sup>^</sup><sup>^</sup> </p>"},{"location":"CondAccess/#alternative-way-to-check-ca-policies","title":"Alternative way to check CA policies","text":"<p>https://idpowertoys.merill.net/ Use the \"CA Documentor\" link on the left &amp; click on \"Manual Generation\" to be able to submit via JSON if you are concerned about the level of permissions required to generate as an App </p> <p>Success</p> <p>Awesome list of CA Policies Chad has done an exceptional piece of work here by creating a master list of 30 CA policies that can be imported/exported as needed - he's also gone and created KQL Queries to be able to track and validate each Policy - sensational work to reduce the effort and friction from our point of view.  https://github.com/chadmcox/Azure_AD_Conditional_Access_Policies It might also be worth checking out his other Projects like: https://github.com/chadmcox/Active_Directory_Scripts </p>"},{"location":"CondAccess/#the-microsoft-content","title":"The\u00a0Microsoft\u00a0content","text":"<ul> <li>Design https://learn.microsoft.com/en-us/azure/architecture/guide/security/conditional-access-design</li> <li>Architecture https://learn.microsoft.com/en-us/azure/architecture/guide/security/conditional-access-architecture</li> <li>Framework https://learn.microsoft.com/en-us/azure/architecture/guide/security/conditional-access-framework</li> <li>API https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-apis</li> <li>Deployment https://github.com/Azure-Samples/azure-ad-conditional-access-apis/tree/main/03-deploy</li> <li>Plan https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/plan-conditional-access</li> <li>CA for Cloud Apps https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-cloud-apps</li> <li>Concept for CA Policies https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-policies</li> <li>Docs https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/</li> <li>Powershell syntax and examples https://learn.microsoft.com/en-us/powershell/module/azuread/get-azureadmsconditionalaccesspolicy?view=azureadps-2.0</li> <li>Deep dive: How does Conditional Access block Legacy Authentication? https://techcommunity.microsoft.com/blog/itopstalkblog/deep-dive-how-does-conditional-access-block-legacy-authentication/3265345</li> </ul> <p>Note</p> <p>Here is a great companion for Sentinel:</p> <p>https://danielchronlund.com/2022/04/21/a-powerfull-conditional-access-change-dashboard-for-microsoft-sentinel/</p>"},{"location":"CondAccess/#automation-of-ca-as-code","title":"Automation of \"CA-as-Code\"","text":"<ul> <li> <p>Thomas N. - https://www.cloud-architekt.net/speaking/ The most recent deck -- 2022-06-11 Scottish Summit 2022 \"Deploying and Managing Conditional Access at Scale\" Slides</p> </li> <li> <p>Excellent article here that is really worth the time reading as this will highlight how to enable this in detail: https://www.cloud-architekt.net/aadops-conditional-access/</p> </li> </ul> <p></p> <p>Tip</p> <p>He also points out the others that have done great work in this space:</p> <ul> <li>Fortigi/ConditionalAccess https://github.com/Fortigi/ConditionalAccess </li> <li>AlexFilipin/ConditionalAccess https://github.com/AlexFilipin/ConditionalAccess</li> <li>DanielChronlund/DCToolbox: Tools for Microsoft cloud fans https://github.com/DanielChronlund/DCToolbox</li> </ul> <p>Info</p> <p>One other important point -- don't get caught up trying to manage GUID's:</p> <ul> <li>Fortigi has published some build scripts on GitHub\u00a0to convert those GUIDs to readable display names.</li> <li>This also covers known GUIDs such as AAD Role and Application ID to DisplayName.</li> </ul>"},{"location":"CondAccess/#validate-and-test","title":"Validate and Test","text":"<ul> <li> <p>Use the WhatIf tool https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/what-if-tool</p> </li> <li> <p>Thomas's page on AAD Ops https://www.cloud-architekt.net/aadops-conditional-access/</p> </li> </ul>"},{"location":"CondAccess/#enable-reporting","title":"Enable Reporting","text":"<ul> <li>How to enable Reporting for CA https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-insights-reporting</li> </ul>"},{"location":"CondAccess/#review-and-improve-as-needed","title":"Review and Improve as needed","text":"<ul> <li> <p>Rerun check with AzureAD Assessment Tool</p> </li> <li> <p>Possible alternative to AAD Assessment tool - CAOptics </p> </li> </ul>"},{"location":"CondAccess/#troubleshooting","title":"Troubleshooting","text":"<ul> <li> <p>Troubleshoot Conditional Access policy https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/plan-conditional-access#troubleshoot-conditional-access-policy</p> </li> <li> <p>Check for common misconfigurations https://www.trustedsec.com/blog/common-conditional-access-misconfigurations-and-bypasses-in-azure/</p> </li> </ul>"},{"location":"GSD/","title":"Get Security Done (GSD) - Microsoft Security &amp; M365 Defender","text":"<p>Quick wins to improve Security using existing M365 E5 entitlements</p> <p>Disclaimer (you know the drill :-) )</p> <ul> <li>Essentially this is \"Notes from the Field\" - not necessarily Best Practices</li> <li>Please use this information wisely, at your own risk</li> <li>Ideally this page will be highlighting how to get the best out of both your M365 E5 security and compliance entitlements. What is the best way to step lightly thru this and gain maximum benefit for the least effort? </li> <li>While most of the focus here is more on the M365 SaaS Security platform elements, not necessarily on Sentinel or Azure, there will be plenty of crossover.</li> </ul> <p></p>"},{"location":"GSD/#core-reference-material","title":"Core reference material","text":"<ul> <li>Microsoft Cybersecurity Reference Architecture -- https://aka.ms/MCRA - Direct link </li> <li>Security collateral inc. CISO Workshops, and lots more -- https://aka.ms/MarksList<ul> <li>Please - if you haven't come across these two links above     before now - go and review and come back after</li> </ul> </li> <li>ASD Essential 8 Security controls - Microsoft Whitepaper - http://aka.ms/e8guides</li> <li>Everything regards M365 Features and Licensing - Feature Matrix | M365 Maps <ul> <li>Aaron Dinnage, Microsoft Canberra</li> <li>Plan comparison in detail - https://aka.ms/M365EnterprisePlans</li> </ul> </li> </ul> <p>A new end-to-end Total Economic Impact study by Forrester across Microsoft's threat protection security portfolio has been released. https://lnkd.in/dw7Hny6d</p> <p>\ud83d\udc49 \u201cThe best example of doing more with less is our #SOC. We have a 24/7 operation with only four people and a $250,000 managed services contract. Without Microsoft\u2019s #XDR solution and everything working in #Sentinel, I would need 12 to 16 people working in the SOC.\u201d</p> <p>\u2705 #ROI 231% \u2705 #Payback in &lt; 6 months \u2705 #Reduced likelihood of a #breach 72% \u2705 #Reduced security license #costs 25%</p> <p>\ud83d\udc49 Get the report: https://lnkd.in/dw7Hny6d</p>"},{"location":"GSD/#latest-ciso-workshop-training","title":"Latest CISO Workshop Training","text":"<p>The Chief Information Security Officer (CISO) Workshop Training </p>"},{"location":"GSD/#incident-response","title":"Incident Response","text":"<ul> <li>CISO Lens Incident Response Template - November 2022 https://www.cisolens.com/reports#h.a769cex3vkl</li> <li>ACSC Exercise in a box https://www.cyber.gov.au/exercise-in-a-box</li> <li>Standardised Executive Reporting - an industry report from the CISO Lens community (June 2022)         https://www.cisolens.com/reports#h.z10davb23frq</li> </ul>"},{"location":"GSD/#m365-defender-console","title":"M365 Defender Console","text":"<ul> <li>Evaluate Defender 365<ul> <li>Good step by step guide to getting everything turned on - but it is aimed at folks just starting</li> <li>https://learn.microsoft.com/en-gb/microsoft-365/security/defender/eval-overview</li> </ul> </li> <li>Test Use Cases     https://learn.microsoft.com/en-gb/microsoft-365/security/defender/integrate-microsoft-365-defender-secops-use-cases</li> <li> <p>SOC Maintenance Tasks     https://learn.microsoft.com/en-gb/microsoft-365/security/defender/integrate-microsoft-365-defender-secops-tasks</p> </li> <li> <p>Deploying Microsoft 365 just got easier - Introducing advanced deployment guides! (Dec 15th, 2022)</p> <p>https://techcommunity.microsoft.com/t5/fasttrack-blog/deploying-microsoft-365-just-got-easier-introducing-advanced/ba-p/3635421</p> </li> </ul> <p></p> <p>Defender Admin Guides - Step by Step</p> <ul> <li>https://setup.microsoft.com/defender</li> <li>https://setup.microsoft.com/defender/identity</li> <li>https://setup.microsoft.com/defender/cloud-apps-setup-guide</li> <li>https://setup.microsoft.com/defender/endpoint-setup-guide</li> <li>https://setup.microsoft.com/defender/office-365-setup-guide</li> <li>https://setup.microsoft.com/intune/setup-guide</li> </ul> <p>Purview Admin Guides - Step by Step</p> <ul> <li>https://setup.microsoft.com/purview</li> <li>https://setup.microsoft.com/purview/audit-solutions-setup-guide</li> <li>https://setup.microsoft.com/purview/ediscovery-solutions-setup-guide</li> <li>https://setup.microsoft.com/purview/insider-risk-solutions-setup-guide</li> <li>https://setup.microsoft.com/purview/data-lifecycle-management-setup-guide</li> <li>https://setup.microsoft.com/purview/information-protection</li> <li>https://setup.microsoft.com/purview/security-analyzer</li> <li>https://setup.microsoft.com/purview/zero-trust-setup-guide</li> </ul> <p></p>"},{"location":"GSD/#1-mdi-microsoft-defender-for-identity","title":"1.   MDI (Microsoft Defender for Identity)","text":""},{"location":"GSD/#ways-of-working","title":"Ways of working","text":"<p>First decision point - do you have ANY Domain Controllers within your environment? If so then you should install MDI NOW and make it the very top of your Security ToDo list.</p> <p>Examples of WHY you do this first:</p> <ul> <li>Small Customer in 2018, back when this was called \"Azure ATP\", installed only as a PoC and in under 48 hours it had identified a mis-configured Server that was exposed to the internet and was being brute-forced via RDP from Eastern Europe.</li> <li>Larger environment 2020, client not sure but was wanting to lock down Legacy Auth, suggested that as they had E5 strong recommendation to deploy MDI ASAP across DC's. After getting CAB Approval to deploy, and with less than 10% coverage of DC's in just over a week it popped up with \"NTDIS Exfil via SMB\"</li> <li>Security Value = Priceless</li> </ul>"},{"location":"GSD/#enable-telemetry","title":"Enable Telemetry","text":"<p>Start here - https://learn.microsoft.com/en-us/defender-for-identity/prerequisites 1.  Capacity planning - https://learn.microsoft.com/en-us/defender-for-identity/capacity-planning 2.  Download the Sizing tool - https://github.com/microsoft/ATA-AATP-Sizing-Tool/releases 3.   Download the Sensor - https://learn.microsoft.com/en-us/defender-for-identity/download-sensor 4.   Install the Sensor on DC's - https://learn.microsoft.com/en-us/defender-for-identity/install-sensor 5.   Basic Settings that you should review NOW - https://www.microsoft.com/videoplayer/embed/RWFVEX</p> <p>This will do for now, especially if you are in a crisis mode, check the console for the DC's being online - now move on to validation below. Please follow up with all other Configuration steps as soon as practible, especially if you also have ADFS in play.  For ADFS please also check - https://learn.microsoft.com/en-us/defender-for-identity/active-directory-federation-services</p> <p></p>"},{"location":"GSD/#validate-and-test","title":"Validate and Test","text":"<p>Be conscious that if you are testing that MDI is working correctly that this may trigger high impact Alerts to your Blue Team or existing SecOps IF it's already installed and being monitored - or for that matter if another tooling is in place to monitor the same behaviour - so if doing some major testing it's worthwhile letting them know before hand? And on that, make sure you schedule some time to review afterwards about what testing/alerting was created &amp; what was visible from a SecOps perspective? </p> <p>This would be valuable lessons on effectiveness - even more so if there is missing alerts?? :( </p> <ul> <li>Specific Validation information - https://learn.microsoft.com/en-us/defender-for-identity/configure-sensor-settings#validate-installations</li> <li>Use Attack Simulations to validate MDI is installed correctly and Alerts are being surfaced accurately:     https://learn.microsoft.com/en-us/defender-for-identity/playbooks</li> <li>Use Labs for in depth checking: https://learn.microsoft.com/en-us/defender-for-identity/playbook-lab-overview</li> <li>https://learn.microsoft.com/en-us/defender-for-identity/playbook-domain-dominance</li> <li>Go to https://portal.atp.azure.com and if you see this, it's not been installed correctly </li> </ul>"},{"location":"GSD/#enable-reporting","title":"Enable Reporting","text":"<p>Once enabled you should now have a lot more visibility into the Security Posture of the onPrem environment - including the following:</p> <ul> <li>Domain controllers with Print Spooler service available</li> <li>Dormant entities in sensitive groups</li> <li>Entities exposing credentials in clear text</li> <li>Microsoft LAPS usage</li> <li>Legacy protocols usage</li> <li>Riskiest lateral movement paths (LMP)</li> <li>Unmonitored domain controllers</li> <li>Unsecure account attributes</li> <li>Unsecure domain configurations</li> <li>Unsecure Kerberos delegation</li> <li>Unsecure SID History attributes</li> <li>Weak cipher usage</li> </ul> <p>More details can be found here &amp; example below - https://learn.microsoft.com/en-us/defender-for-identity/security-assessment#assessment-reports </p>"},{"location":"GSD/#review-and-improve-as-needed","title":"Review and Improve as needed","text":"<ul> <li>Review Security Assessments to validate what potentially needs remediation: https://learn.microsoft.com/en-us/defender-for-identity/security-assessment#assessment-reports</li> <li>Full list of the 44 Alerts that are being checked on your behalf when fully deployed: https://learn.microsoft.com/en-us/defender-for-identity/alerts-overview</li> <li>If you do not use the default Administrator account (ideally have it disabled?) then please add it to the Honeytoken account list: https://learn.microsoft.com/en-us/defender-for-identity/entity-tags#honeytoken-tags</li> <li>Audit checking via Sentinel for MDI - https://thalpius.com/2022/12/14/microsoft-defender-for-identity-auditing-checker-using-sentinel</li> </ul>"},{"location":"GSD/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>https://learn.microsoft.com/en-us/defender-for-identity/troubleshooting-known-issues</li> <li>https://learn.microsoft.com/en-us/defender-for-identity/troubleshooting-using-logs</li> </ul>"},{"location":"GSD/#2-conditional-access","title":"2.   Conditional Access","text":""},{"location":"GSD/#ways-of-working_1","title":"Ways of working","text":"<p>First decision point - how are we going to do this? Questions to help you determine this are:</p> <ol> <li>Is it small or a large Tenancy?</li> <li>Do we want to avoid CAB approval process for a PoC?</li> <li>Need it done right now to address a strategic problem?</li> <li>Do we want to go fast, or take our time?</li> <li>If you are a Partner or MSSP please choose the \"As-Code\" method</li> </ol> <p>Result:</p> <ul> <li>Fast and quick - start with telemetry below and do it on the fly using Policies in Reporting Mode, iterate from there...</li> <li>Larger implmentations - please take the time to review the process below to enable via \"CA-as-Code\" as the ROI is well worth it - especially if doing it for more than one customer or tenant </li> </ul>"},{"location":"GSD/#enable-telemetry_1","title":"Enable Telemetry","text":"<p>NOTE: please be aware there is no inherent \"BLOCK\" by default</p> <p>You need to make sure you are BLOCKING by default unless explicitly allowing access - walk thru the 14 default Policies to better understand this. To make sure that you are fully covered please use this\u00a0PowerBI based tool https://github.com/AzureAD/AzureADAssessment Confirm your maturity based on this Tool <sup>^</sup><sup>^</sup> </p> <p>Note</p> <p>UPDATE 142 Page - CA demystified Whitepaper - still to be reviewed  https://github.com/kennethvs/cabaseline202212/blob/main/Conditional%20Access%20demystified-v1.4%20-%20December%202022.pdf </p>"},{"location":"GSD/#the-microsoft-content","title":"The\u00a0Microsoft\u00a0content","text":"<ul> <li>Design - https://learn.microsoft.com/en-us/azure/architecture/guide/security/conditional-access-design</li> <li>Architecture - https://learn.microsoft.com/en-us/azure/architecture/guide/security/conditional-access-architecture</li> <li>Framework - https://learn.microsoft.com/en-us/azure/architecture/guide/security/conditional-access-framework</li> <li>API - https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-apis</li> <li>Deployment - https://github.com/Azure-Samples/azure-ad-conditional-access-apis/tree/main/03-deploy</li> <li>Plan - https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/plan-conditional-access</li> <li>CA for Cloud Apps - https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-cloud-apps</li> <li>Concept for CA Policies - https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/concept-conditional-access-policies</li> <li>Docs - https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/</li> <li>Powershell syntax and examples - https://learn.microsoft.com/en-us/powershell/module/azuread/get-azureadmsconditionalaccesspolicy?view=azureadps-2.0</li> <li>Deep dive: How does Conditional Access block Legacy Authentication? - https://techcommunity.microsoft.com/t5/itops-talk-blog/deep-dive-how-does-conditional-access-block-legacy/ba-p/3265345</li> </ul> <p>Note</p> <p>Here is a great companion for Sentinel:  https://danielchronlund.com/2022/04/21/a-powerfull-conditional-access-change-dashboard-for-microsoft-sentinel/</p>"},{"location":"GSD/#automation-of-ca-as-code","title":"Automation of \"CA-as-Code\"","text":"<ul> <li> <p>Thomas N. - https://www.cloud-architekt.net/speaking/ The most recent deck -- 2022-06-11 Scottish Summit 2022 \"Deploying and Managing Conditional Access at Scale\" Slides</p> </li> <li> <p>Excellent article here that is really worth the time reading as this will highlight how to enable this in detail: https://www.cloud-architekt.net/aadops-conditional-access/</p> </li> </ul> <p></p> <p>Tip</p> <p>He also points out the others that have done great work in this space:</p> <ul> <li>Fortigi/ConditionalAccess: (https://github.com/Fortigi/ConditionalAccess)</li> <li>AlexFilipin/ConditionalAccess: (https://github.com/AlexFilipin/ConditionalAccess)</li> <li>DanielChronlund/DCToolbox: Tools for Microsoft cloud fans (https://github.com/DanielChronlund/DCToolbox)</li> </ul> <p>Info</p> <p>One other important point -- don't get caught up trying to manage GUID's:</p> <ul> <li>Fortigi has published some build scripts on GitHub\u00a0to convert those GUIDs to readable display names.</li> <li>This also covers known GUIDs such as AAD Role and Application ID to DisplayName.</li> </ul>"},{"location":"GSD/#validate-and-test_1","title":"Validate and Test","text":"<p>https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/what-if-tool</p> <p>https://www.cloud-architekt.net/aadops-conditional-access/</p>"},{"location":"GSD/#enable-reporting_1","title":"Enable Reporting","text":"<p>https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-insights-reporting</p>"},{"location":"GSD/#review-and-improve-as-needed_1","title":"Review and Improve as needed","text":"<p>Rerun check with AzureAD Assessment Tool</p>"},{"location":"GSD/#troubleshooting_1","title":"Troubleshooting","text":"<p>https://learn.microsoft.com/en-us/azure/active-directory/conditional-access/plan-conditional-access#troubleshoot-conditional-access-policy</p> <p>Check for common misconfigurations - https://www.trustedsec.com/blog/common-conditional-access-misconfigurations-and-bypasses-in-azure/</p>"},{"location":"GSD/#3-microsoft-defender-for-cloud-apps-mdca-was-mcas","title":"3.   Microsoft Defender for Cloud Apps (MDCA), was MCAS)","text":""},{"location":"GSD/#ways-of-working_2","title":"Ways of working","text":"<p>First decision point - Simple or Complex, i.e. do you need to be concerned about RBAC for instance becuase of the scale of the installation or the number of different parties that may need access to part or some parts of the console?  https://learn.microsoft.com/en-us/defender-cloud-apps/manage-admins</p>"},{"location":"GSD/#enable-telemetry_2","title":"Enable Telemetry","text":"<ul> <li>Basic Setup --&gt; Start here: https://learn.microsoft.com/en-us/defender-cloud-apps/general-setup https://learn.microsoft.com/en-us/defender-cloud-apps/get-started</li> <li>Tell it what the Corporate IP address's are:  https://learn.microsoft.com/en-us/defender-cloud-apps/ip-tags</li> <li>Set the IP's in bulk if needed: https://learn.microsoft.com/en-us/defender-cloud-apps/api-data-enrichment-manage-script</li> <li>Enable File Monitoring: https://learn.microsoft.com/en-us/defender-cloud-apps/file-filters</li> <li>Add native App Connectors: (Atlassian, Google, Azure, AWS, Box, DocuSign, Github, Okta, Salesforce, ServiceNow, Slack, Workday, etc... ) https://learn.microsoft.com/en-us/defender-cloud-apps/enable-instant-visibility-protection-and-governance-actions-for-your-apps</li> <li>Best Practices: https://learn.microsoft.com/en-us/defender-cloud-apps/best-practices</li> <li>Daily Activities: https://learn.microsoft.com/en-us/defender-cloud-apps/daily-activities-to-protect-your-cloud-environment</li> </ul> <p>The best practices discussed in the link above include:</p> <ul> <li>Discover and assess cloud apps</li> <li>Apply cloud governance policies</li> <li>Limit exposure of shared data and enforce collaboration policies</li> <li>Discover, classify, label, and protect regulated and sensitive data stored in the cloud</li> <li>Enforce DLP and compliance policies for data stored in the cloud</li> <li>Block and protect download of sensitive data to unmanaged or risky devices</li> <li>Secure collaboration with external users by enforcing real-time session controls</li> <li>Detect cloud threats, compromised accounts, malicious insiders, and ransomware</li> <li>Use the audit trail of activities for forensic investigations</li> <li>Secure IaaS services and custom apps</li> </ul> <p>Warning</p> <ul> <li>For best protection, we recommend selecting all Office 365 components.</li> <li>The Office 365 files component, requires the Office 365 activities component and Defender for Cloud Apps file monitoring (Settings &gt; Files &gt; Enable file monitoring).</li> <li>Make sure the last checkbox (Office 365 Files) in the image below is \"checked\" link to more details </li> </ul> <p></p>"},{"location":"GSD/#validate-and-test_2","title":"Validate and Test","text":"<ul> <li>Enable MDE Integration https://learn.microsoft.com/en-us/defender-cloud-apps/mde-integration </li> <li>Enable MDI Integration https://learn.microsoft.com/en-us/defender-cloud-apps/mdi-integration</li> <li>Govern discovered Apps using MDE (enables blocking of unwanted Apps) https://learn.microsoft.com/en-us/defender-cloud-apps/mde-govern</li> <li>Investigating via Dashboard: https://learn.microsoft.com/en-us/defender-cloud-apps/investigate</li> <li>Tune the system:  https://learn.microsoft.com/en-us/defender-cloud-apps/tutorial-suspicious-activity</li> <li>Investigate &amp; remediate risky OAuth Apps: https://learn.microsoft.com/en-us/defender-cloud-apps/investigate-risky-oauth</li> </ul> <p>Note</p> <ul> <li>It takes up to two hours after you enable the integration for the data to show up in Defender for Cloud Apps.</li> <li>List of supported Firewalls and Proxies</li> <li>Follow link above for Integration steps with ZScaler, iboss, Menlo, etc...</li> </ul> <p></p>"},{"location":"GSD/#enable-reporting_2","title":"Enable Reporting","text":"<ul> <li>Investigate Apps discovered by MDE  https://learn.microsoft.com/en-us/defender-cloud-apps/mde-investigation</li> <li>Governance for Connected Apps: https://learn.microsoft.com/en-us/defender-cloud-apps/governance-actions This is where this process gets really good, have a real good look at all the possibilities here to be able to be able to track what is being done with data inside the environment - don't jump in &amp; start blocking things before you understand the full business implications. </li> <li>Governance for discovered Apps: https://learn.microsoft.com/en-us/defender-cloud-apps/governance-discovery Now we can take this one step further and we can now determine which of the 26,000 SaaS Apps I want to allow or block - the only real limitation (to a certain extent) is that the user is using corporate credentials from our AAD via an endpoint enabled with MDE </li> </ul>"},{"location":"GSD/#review-and-improve-as-needed_2","title":"Review and Improve as needed","text":"<ul> <li>Add Conditional Access App Control into the mix - this is where we are starting to get more into Zero Trust - so don't jump in here first, make sure the rest of the Security settings are in place and then come back to this in a later phase https://learn.microsoft.com/en-us/defender-cloud-apps/proxy-intro-aad</li> </ul> <p>There is a lot more to be covered, but this will do for now, if you have questions please let us know? https://github.com/dcaddick/gsd_public/discussions</p>"},{"location":"GSD/#troubleshooting_2","title":"Troubleshooting","text":"<ul> <li>Advanced Settings URL: https://security.microsoft.com/cloudapps/settings</li> <li> <p>Troubleshooting:  https://learn.microsoft.com/en-us/defender-cloud-apps/troubleshooting-cloud-discovery</p> </li> <li> <p>Apps list</p> </li> <li>Sanctioned/Unsanctioned</li> <li>Don't forget this is based on MDE so go back and check the MDE integration link above \u00a0</li> </ul>"},{"location":"GSD/#4-mde-microsoft-defender-for-endpoint","title":"4.   MDE (Microsoft Defender for Endpoint)","text":""},{"location":"GSD/#ways-of-working_3","title":"Ways of working","text":"<p>Defender for Endpoint is for Endpoints, Servers actually belong in \"Defender for Cloud\": https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/migrating-mde-server-to-cloud</p> <ul> <li> <p>Architecture PDF https://download.microsoft.com/download/5/6/0/5609001f-b8ae-412f-89eb-643976f6b79c/mde-deployment-strategy.pdf</p> </li> <li> <p>Plan your deployement https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/deployment-strategy?view=o365-worldwide</p> </li> <li> <p>MDE Deployment overview https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/deployment-phases?view=o365-worldwide</p> </li> <li> <p>Phase 1 - Prepare Link</p> <ul> <li>Stakeholders and approval</li> <li>Environment</li> <li>RBAC</li> <li>Adoption Order</li> </ul> </li> <li> <p>Phase 2 - Setup Link</p> <ul> <li>Check License state</li> <li>CSP Validation</li> <li>Tenant Config</li> <li>Data Centre location</li> <li>Network Config</li> </ul> </li> <li> <p>Phase 3 - Onbaording Link</p> <ul> <li>Onboarding &amp; Config</li> <li>Deployment Rings</li> <li>Using Config Manager</li> <li>Using MEM</li> </ul> </li> </ul> <p></p>"},{"location":"GSD/#enable-telemetry_3","title":"Enable Telemetry","text":"<ul> <li> <p>Onbarding &amp; Configuration https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/onboarding-endpoint-manager?view=o365-worldwide</p> </li> <li> <p>Configure Device Discovery https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-device-discovery</p> </li> <li>Check it's working --&gt; using Simulated Attacks https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-simulations</li> <li>Automation Levels https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/automation-levels?</li> <li>Configure AIR capabilities https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-automated-investigations-remediation</li> <li>Attack Surface Reduction (ASR) rules https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction</li> <li> <p>ASR Rules Deployment https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-deployment</p> </li> <li> <p>Attack surface reduction (ASR) rules report https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-report?</p> </li> </ul>"},{"location":"GSD/#validate-and-test_3","title":"Validate and Test","text":"<ul> <li>Scenarios &amp; Features listed with links to testing https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/defender-endpoint-demonstrations</li> <li>Block at First Sight - test/demo https://demo.wd.microsoft.com/Page/BAFS</li> <li>Demonstrate &amp; Test security controls: ASR, SmartScreen, PUA, etc...  https://demo.wd.microsoft.com/</li> </ul>"},{"location":"GSD/#migration","title":"Migration","text":"<ul> <li> <p>Migration Guide https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/migration-guides?</p> </li> <li> <p>Migrate to MDE from non-Microsoft endpoint protection https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/switch-to-mde-overview?</p> </li> <li> <p>Manage Microsoft Defender for Endpoint after initial setup or migration https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/manage-mde-post-migration?</p> </li> </ul>"},{"location":"GSD/#enable-reporting_3","title":"Enable Reporting","text":"<p>Consider consolidating All reporting below into Workbooks in Sentinel, this can typically be provided by a Partner, part of an MSSP process, or you can roll your own?</p> <ul> <li> <p>Device health reports in MDE https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/device-health-reports?</p> </li> <li> <p>Manage MDE Devices with MEM https://learn.microsoft.com/en-us/mem/intune/protect/mde-security-integration</p> </li> <li> <p>Fix unhealthy sensors in MDE https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/fix-unhealthy-sensors?</p> </li> <li> <p>Host firewall reporting in MDE https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/host-firewall-reporting?view=o365-worldwide</p> </li> <li> <p>MDE PowerBI https://github.com/microsoft/MicrosoftDefenderForEndpoint-PowerBI</p> </li> <li> <p>PowerShell scripts using MDE public API https://github.com/microsoft/MicrosoftDefenderATP-API-PowerShell</p> </li> <li> <p>MDE Advanced Hunting (AH) sample queries https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries</p> </li> <li> <p>Python scripts using MDE public API https://github.com/microsoft/MicrosoftDefenderATP-API-Python</p> </li> </ul>"},{"location":"GSD/#review-and-improve-as-needed_3","title":"Review and Improve as needed","text":"<ul> <li> <p>Consider enabling Block at First Sight from AV: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-block-at-first-sight-microsoft-defender-antivirus</p> </li> <li> <p>Linux Advanced Guidance: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/comprehensive-guidance-on-linux-deployment</p> </li> </ul>"},{"location":"GSD/#troubleshooting_3","title":"Troubleshooting","text":"<ul> <li>Troubleshooting: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/check-sensor-status</li> <li>Troubleshooting mode for devices: https://jeffreyappel.nl/microsoft-defender-for-endpoint-troubleshooting-mode-how-to-use-it/</li> <li>Migration Guide: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/migration-guides</li> </ul>"},{"location":"GSD/#m365-rbac","title":"M365 RBAC","text":"<p>Released late Dec 2022</p> <ul> <li>Shortcut to RBAC Permissions https://security.microsoft.com/mtp_roles</li> <li>Compare RBAC Roles https://learn.microsoft.com/en-us/microsoft-365/security/defender/compare-rbac-roles?</li> <li>Edit and Delete Roles https://learn.microsoft.com/en-us/microsoft-365/security/defender/edit-delete-rbac-roles? </li> </ul>"},{"location":"GSD/#mde-using-asr-stand-alone-e3","title":"MDE using ASR stand-alone (E3)","text":"<p>Handy tips and shortcuts for those that might still be trying to improve based on M365 E3 Licensing - apologies but this is not my focus, but when I do come across useful tips and links I'll add here:</p> <ul> <li>https://www.computerworld.com/article/3604651/decoding-windows-defender-s-hidden-settings.html</li> <li>https://github.com/AndyFul/ConfigureDefender</li> <li>https://www.defenderui.com/</li> <li>https://github.com/beerisgood/Windows11_Hardening</li> <li>https://jeffreyappel.nl/microsoft-defender-for-endpoint-series-define-the-av-baseline-part4a/</li> </ul>"},{"location":"GSD/#mde-from-mvps","title":"MDE (from MVP's)","text":"<ul> <li>Defender for Endpoint Policy Must Haves -     https://www.linkedin.com/posts/emannon_1dfv-2dfv-3dfv-activity-6989618122601230338-q2uK?</li> <li>Do you use Defender for Endpoint -     https://www.linkedin.com/posts/emannon_defender-mde-zeek-activity-6989307538726948864-C2Oj?</li> <li> <ol> <li>Do you use MDE for EDR/NGAV\u2753</li> </ol> </li> <li> <ol> <li>Did you deploy the MDE network scanner\u2049\ufe0f     https://www.linkedin.com/posts/emannon_msftadvocate-defender-iotsecurity-activity-6986838402071478272-dLRV?</li> </ol> </li> <li>https://jeffreyappel.nl/microsoft-defender-for-endpoint-series-what-is-defender-for-endpoint-part1/</li> <li>https://jeffreyappel.nl/microsoft-defender-for-endpoint-series-configure-defender-for-endpoint-part2/</li> <li>https://jeffreyappel.nl/microsoft-defender-for-endpoint-series-onboard-defender-for-endpoint-part3/</li> <li>https://jeffreyappel.nl/microsoft-defender-for-endpoint-series-onboard-using-microsoft-intune-part3a/</li> <li>https://jeffreyappel.nl/microsoft-defender-for-endpoint-series-onboard-using-defender-for-cloud-part3b/</li> <li>https://jeffreyappel.nl/microsoft-defender-for-endpoint-series-onboard-using-azure-arc-part3c/</li> <li>https://jeffreyappel.nl/microsoft-defender-for-endpoint-series-onboard-using-gpo-mecm-part3d/</li> <li>https://jeffreyappel.nl/microsoft-defender-for-endpoint-series-configure-av-next-generation-protection-part4/</li> <li>https://jeffreyappel.nl/microsoft-defender-for-endpoint-series-define-the-av-baseline-part4a/</li> </ul> <p>### Migration</p> <ul> <li>https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/migration-guides</li> <li>https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/switch-to-mde-overview</li> </ul>"},{"location":"GSD/#5-mdo-microsoft-defender-for-office","title":"5.   MDO (Microsoft Defender for Office)","text":"<ul> <li>Features https://learn.microsoft.com/en-us/office365/servicedescriptions/microsoft-defender-for-office-365-features</li> </ul> <p>Recent BEC activity (Business Email Compromise) https://x.com/jhencinski/status/1616543412940931075?s=61&amp;t=C1HAZW3QfTIcWUDtZNoHOw</p>"},{"location":"GSD/#ways-of-working_4","title":"Ways of working","text":"<ul> <li>Top 20 most-viewed admin help articles this month https://learn.microsoft.com/en-us/microsoft-365/admin/top-m365-admin-articles?view=o365-worldwide</li> <li>How to secure your business data with Microsoft 365 for business https://learn.microsoft.com/en-us/microsoft-365/admin/security-and-compliance/secure-your-business-data?view=o365-worldwide</li> <li>Basic authentication sign-in prompts are blocked by default in Microsoft 365 Apps https://learn.microsoft.com/en-us/deployoffice/security/basic-authentication-prompts-blocked</li> </ul>"},{"location":"GSD/#enable-telemetry_4","title":"Enable Telemetry","text":"<ul> <li> <p>Step-by-Step guide https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/step-by-step-guides/step-by-step-guide-overview</p> </li> <li> <p>Try in Audit mode https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/try-microsoft-defender-for-office-365</p> </li> <li> <p>Enhanced Filters aka Skip Listing (use for Migration) https://learn.microsoft.com/en-us/Exchange/mail-flow-best-practices/use-connectors-to-configure-mail-flow/enhanced-filtering-for-connectors Especially this last one on Enhanced Filters, this is where it is possible to enable MDO to co-exist with what ever 3rd party system you are using today, but it will typically require an MX record change, and is not an undertaking to be taken lightly. The main point - it is possible to have co-existense - but this should NOT be seen as a long term process!!   </p> </li> <li> <p>Data retention information for Microsoft Defender for Office 365 https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/mdo-data-retention?view=o365-worldwide</p> </li> </ul>"},{"location":"GSD/#validate-and-test_4","title":"Validate and Test","text":"<ul> <li>AIR - make sure you Enable this https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/office-365-air</li> <li> <p>How AIR works https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/office-365-air</p> </li> <li> <p>Integrate Microsoft Defender for Endpoint with Microsoft Defender for Cloud Apps https://learn.microsoft.com/en-us/defender-cloud-apps/mde-integration</p> </li> </ul>"},{"location":"GSD/#enable-reporting_4","title":"Enable Reporting","text":"<ul> <li> <p>Protect against Threats https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/protect-against-threats</p> </li> <li> <p>What is ZAP? Zero-hour auto purge (ZAP) in Exchange Online https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/zero-hour-auto-purge?view=o365-worldwide</p> </li> <li> <p>Alert Policies in Microsoft 365 https://learn.microsoft.com/en-us/microsoft-365/compliance/alert-policies?view=o365-worldwide</p> </li> <li> <p>Manage mailbox auditing https://learn.microsoft.com/en-us/microsoft-365/compliance/audit-mailboxes?view=o365-worldwide</p> </li> <li> <p>Audit log activities https://learn.microsoft.com/en-us/microsoft-365/compliance/audit-log-activities?view=o365-worldwide</p> </li> <li> <p>View dashboards and reports in the Microsoft 365 Defender portal https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/tenant-wide-setup-for-increased-security?view=o365-worldwide#view-dashboards-and-reports-in-the-microsoft-365-defender-portal</p> </li> </ul>"},{"location":"GSD/#review-and-improve-as-needed_4","title":"Review and Improve as needed","text":"<ul> <li> <p>Tune anti-phishing protection https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-phishing-protection-tuning?view=o365-worldwide</p> </li> <li> <p>Review and manage remediation actions in Office 365 https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/air-review-approve-pending-completed-actions?view=o365-worldwide</p> </li> <li> <p>Detect &amp; Address compromised user accounts with automated investigation and response https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/address-compromised-users-quickly?view=o365-worldwide</p> </li> <li> <p>Detect and Remediate Illicit Consent Grants https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/detect-and-remediate-illicit-consent-grants?view=o365-worldwide</p> </li> <li> <p>Detect &amp; Respond to a compromised connector https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/connectors-detect-respond-to-compromise?view=o365-worldwide</p> </li> <li> <p>Config Analyzer https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/configuration-analyzer-for-security-policies</p> </li> <li> <p>Recommended Settings https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/recommended-settings-for-eop-and-office365</p> </li> <li> <p>SecOps Guide https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/mdo-sec-ops-guide</p> </li> <li> <p>Macros from the internet will be blocked by default in Office https://learn.microsoft.com/en-us/deployoffice/security/internet-macros-blocked</p> </li> <li> <p>Trusted Locations for Office files https://learn.microsoft.com/en-us/deployoffice/security/trusted-locations </p> </li> </ul>"},{"location":"GSD/#troubleshooting_4","title":"Troubleshooting","text":"<ul> <li> <p>Troubleshooting mail sent to Microsoft 365 https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/mail-flow-troubleshooting?view=o365-worldwide</p> </li> <li> <p>Roles and role groups in Microsoft Defender for Office 365 and Microsoft Purview compliance https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/scc-permissions?view=o365-worldwide</p> </li> <li> <p>Monitor for leaks of personal data https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/monitor-for-leaks-of-personal-data?view=o365-worldwide </p> </li> <li> <p>Privileged Identity Management (PIM) and why to use it with Microsoft Defender for Office 365 https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/use-privileged-identity-management-in-defender-for-office-365?view=o365-worldwide</p> </li> <li> <p>Add support for anonymous inbound email over IPv6 in Microsoft 365 https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/mail-flow-inbound-ipv6-support-about?view=o365-worldwide</p> </li> </ul>"},{"location":"GSD/#6-mdc-microsoft-defender-for-cloud","title":"6.   MDC (Microsoft Defender for Cloud)","text":""},{"location":"GSD/#mdc-microsoft-defender-for-cloud","title":"MDC (Microsoft Defender for Cloud)","text":""},{"location":"GSD/#ways-of-working_5","title":"Ways of working","text":"<ul> <li> <p>Deploying and Managing Microsoft Defender for Cloud as Code https://techcommunity.microsoft.com/t5/microsoft-defender-for-cloud/deploying-and-managing-microsoft-defender-for-cloud-as-code/ba-p/3649653</p> </li> <li> <p>How to deploy MDC at scale - Video https://www.youtube.com/watch?v=o9wHIS_QLJE</p> </li> <li> <p>A quick HowTo with step by step instructions to get started - How to Set Up and Use Microsoft Defender for Cloud https://www.reblaze.com/blog/microsoft-azure-security/how-to-set-up-and-use-microsoft-defender-for-cloud/</p> </li> <li> <p>Scale a Defender for Servers deployment https://learn.microsoft.com/en-us/azure/defender-for-cloud/plan-defender-for-servers-scale</p> </li> <li> <p>Use Azure Policies to drive each area as you progress      (work smarter, not harder)</p> <ul> <li> <p>Use the following policies to enable the particular Defender for Cloud plans:  </p> </li> <li> <p>Configure Azure Defender for servers to be enabled </p> </li> <li>Configure Azure Defender for SQL servers on machines to be enabled </li> <li>Configure Azure Defender for Azure SQL database to be enabled </li> <li>Configure Azure Defender for Storage to be enabled </li> <li>Configure Azure Defender for App Service to be enabled </li> <li>Configure Azure Defender for DNS to be enabled </li> <li>Configure Azure Defender for Key Vaults to be enabled </li> <li>Configure Azure Defender for open-source relational databases to be enabled </li> <li>Configure Azure Defender for Resource Manager to be enabled</li> </ul> </li> </ul>"},{"location":"GSD/#enable-telemetry_5","title":"Enable Telemetry","text":"<ul> <li> <p>How to Effectively Perform a Microsoft Defender for Cloud PoC (updated March 2022) https://techcommunity.microsoft.com/t5/microsoft-defender-for-cloud/how-to-effectively-perform-a-microsoft-defender-for-cloud-poc/ba-p/516874</p> </li> <li> <p>Microsoft Defender for Cloud Lab http://aka.ms/MDFCLabs</p> </li> <li> <p>Quickstart: Enable enhanced security features https://learn.microsoft.com/en-us/azure/defender-for-cloud/enable-enhanced-security </p> </li> </ul>"},{"location":"GSD/#validate-and-test_5","title":"Validate and Test","text":"<ul> <li> <p>Alert validation in Microsoft Defender for Cloud https://learn.microsoft.com/en-us/azure/defender-for-cloud/alert-validation </p> </li> <li> <p>Simulate Alerts in Azure VM's, Linux VM's and Kubernates https://learn.microsoft.com/en-us/azure/defender-for-cloud/alert-validation#simulate-alerts-on-your-azure-vms-windows-</p> </li> <li> <p>How to validate Azure Key Vault Threat Detection alerts https://techcommunity.microsoft.com/t5/microsoft-defender-for-cloud/validating-azure-key-vault-threat-detection-in-microsoft/ba-p/1220336</p> </li> <li> <p>Trigger a test alert for Microsoft Defender for Storage https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-storage-test</p> </li> </ul>"},{"location":"GSD/#enable-reporting_5","title":"Enable Reporting","text":"<ul> <li> <p>Tutorial: Improve your regulatory compliance https://learn.microsoft.com/en-us/azure/defender-for-cloud/regulatory-compliance-dashboard</p> </li> <li> <p>Microsoft Defender for Cloud threat intelligence report https://learn.microsoft.com/en-us/azure/defender-for-cloud/threat-intelligence-reports</p> </li> </ul>"},{"location":"GSD/#review-and-improve-as-needed_5","title":"Review and Improve as needed","text":"<ul> <li> <p>Security posture for Microsoft Defender for Cloud https://learn.microsoft.com/en-us/azure/defender-for-cloud/secure-score-security-controls </p> </li> <li> <p>Implement security recommendations in Microsoft Defender for Cloud https://learn.microsoft.com/en-us/azure/defender-for-cloud/implement-security-recommendations</p> </li> <li> <p>Find recommendations that can improve your security posture https://learn.microsoft.com/en-us/azure/defender-for-cloud/review-security-recommendations</p> </li> </ul>"},{"location":"GSD/#troubleshooting_5","title":"Troubleshooting","text":"<ul> <li>MDC Troubleshooting Guide https://learn.microsoft.com/en-us/azure/defender-for-cloud/troubleshooting-guide </li> </ul>"},{"location":"GSD/#7-sentinel-tips-from-the-field","title":"7.   Sentinel Tips from the Field","text":""},{"location":"GSD/#sentinel-tips-from-the-field","title":"Sentinel Tips from the Field","text":"<p>You want SOAR?</p> <ul> <li>Most folks skip Defender in preference for Sentinel...  </li> <li>Start from the desired outcome and work your way back from there</li> <li>What is it that SecOps need? - more automation, less manual work ;-)</li> <li>What does that look like? Showcase an example from Contoso Hotels</li> <li>Enable Automated Investigation &amp; Remediation (AIR) at MDI, MDO, MDE and M365 Defender console levels - don't skip this! - as this enables SOAR \"at source\"</li> <li>Now that we have the first level triage in place, let's now move on to Sentinel...</li> </ul>"},{"location":"GSD/#ways-of-working_6","title":"Ways of working","text":"<ul> <li>Raw logs by their very nature have a significant cost related to \"data gravity\" - the more Customers move/copy the logs the more complex the environment as well as more expensive the solution becomes - the design principle that should be recommend is to adhere to the MS Best Practices as much as possible.     https://learn.microsoft.com/en-us/azure/sentinel/best-practices-data</li> <li>Should there be any business justification or requirement for \"raw logs\" please consider a much more efficient method is the ability to stream \"advanced hunting\" events</li> <li>Please make sure that any request from SecOps for anything more than Alerts/Incidents (like request for raw data) is balanced against cost via Business Case Justification</li> <li>Why ingest or duplicate massive data sets across multiple systems based on a \"just in case\" scenario</li> <li>A much more efficient system would be to define the \"advanced hunting\" event that is being searched for and as and when matches are discovered the event is forwarded</li> <li>This process will respect data gravity and reduce costs significantly</li> <li>More information can be found here: Advanced hunting event collection</li> </ul>"},{"location":"GSD/#reducing-ttr","title":"Reducing TTR","text":"<ul> <li> <p>General recommendation is for Customers to focus efforts on increasing efficiency and reducing TTR (time to remediate) via Automation &amp; SOAR natively within Microsoft Sentinel will naturally improve C3 (SecOps) efficiency without the need for any additional tools.</p> <ul> <li>More information:</li> <li>CISO series: Lessons learned from the Microsoft SOC---Part 3a: Choosing SOC tools</li> <li>CISO series: Lessons learned from the Microsoft SOC---Part 3b: A day in the life</li> <li>CISO Series: Lessons learned from the Microsoft SOC---Part 3c: A day in the life part 2</li> </ul> </li> <li> <p>Focus on bringing all source logging relevant to the Users Device into the one location where it can be corelated quickly and seamlessly into a SOAR process to reduce friction and improve TTR times for SecOps</p> </li> <li>More information https://docs.microsoft.com/en-us/azure/sentinel/microsoft-365-defender-sentinel-integration</li> </ul>"},{"location":"GSD/#enable-telemetry_6","title":"Enable Telemetry","text":"<ul> <li>Best practices for Microsoft Sentinel https://learn.microsoft.com/en-us/azure/sentinel/best-practices</li> <li>Best practices for designing a Microsoft Sentinel or Azure Defender for Cloud workspace https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/best-practices-for-designing-a-microsoft-sentinel-or-azure/ba-p/832574</li> <li>Extend Microsoft Sentinel across workspaces and tenants https://learn.microsoft.com/en-us/azure/sentinel/extend-sentinel-across-workspaces-tenants</li> <li>Microsoft Sentinel workspace architecture best practices https://learn.microsoft.com/en-us/azure/sentinel/best-practices-workspace-architecture</li> </ul>"},{"location":"GSD/#validate-and-test_6","title":"Validate and Test","text":"<ul> <li> <p>How to Generate Microsoft Sentinel Incidents for Testing and Demos https://rodtrent.substack.com/p/how-to-generate-microsoft-sentinel</p> </li> <li> <p>Microsoft Sentinel \u2014 Testing detection rules like a Ninja https://rogierdijkman.medium.com/microsoft-sentinel-testing-detection-rules-like-a-ninja-cac612944dd1</p> </li> <li> <p>Learning with the Microsoft Sentinel Training Lab https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/learning-with-the-microsoft-sentinel-training-lab/ba-p/2953403</p> </li> </ul>"},{"location":"GSD/#enable-reporting_6","title":"Enable Reporting","text":"<ul> <li> <p>Tutorial: Create a Power BI report from Microsoft Sentinel data https://learn.microsoft.com/en-us/azure/sentinel/powerbi</p> </li> <li> <p>Investigate incidents with Microsoft Sentinel https://learn.microsoft.com/en-us/azure/sentinel/investigate-cases </p> </li> <li> <p>Automatically create incidents from Microsoft security alerts https://learn.microsoft.com/en-us/azure/sentinel/create-incidents-from-alerts</p> </li> </ul>"},{"location":"GSD/#review-and-improve-as-needed_6","title":"Review and Improve as needed","text":""},{"location":"GSD/#filtering-logs","title":"Filtering Logs","text":"<p>Can be used to reduce data noise, reduce ingestion and retention/storage costs with the goal being to focus on the logs and events that are relevant - This is typically performed by one of the methods for the following scenarios:</p> <ul> <li> <p>Server Log Ingestion - Azure Monitor Agent Directly can filter out logs that are not relevant for Microsoft Sentinel     https://docs.microsoft.com/en-us/azure/sentinel/best-practices-data#filter-your-logs-before-ingestion</p> </li> <li> <p>Syslog and CEF Ingestion -- Using a log forwarder such as Logstash can parse the logs based on Customers defined rules    https://docs.microsoft.com/en-us/azure/sentinel/best-practices-data#filter-your-logs-before-ingestion</p> </li> <li> <p>Custom REST API Ingestion -- Via the Function or Logic App, data can be stripped away prior to sending to Microsoft sentinel - please see following two links    https://learn.microsoft.com/en-us/azure/sentinel/data-transformation https://learn.microsoft.com/en-us/azure/sentinel/configure-data-transformation</p> </li> </ul>"},{"location":"GSD/#cost-optimization","title":"Cost Optimization","text":"<ul> <li>Who knew? right ;) everyone  who has installed this finds it's too expensive?</li> <li>It's actually not - IF you're diligent and methodical about how you care and look after your Sentinel deployment AFTER it's deployed</li> <li>Almost like any piece of software - it needs to have an SDLC approach - once deployed (and indeed, every time you add another Data Connector) set a calendar reminder to go back and review costs/storage/trends a month later - exactly </li> <li> <p>Here's some other tips...</p> </li> <li> <p>Free data sources https://learn.microsoft.com/en-us/azure/sentinel/billing?tabs=free-data-meters#free-data-sources</p> </li> <li>View costs by using cost analysis https://learn.microsoft.com/en-us/azure/sentinel/billing-monitor-costs#view-costs-by-using-cost-analysis</li> <li>Run KQL queries to understand your data ingestion https://learn.microsoft.com/en-us/azure/sentinel/billing-monitor-costs#run-queries-to-understand-your-data-ingestion</li> <li>Deploy a workbook to visualize data ingestion https://learn.microsoft.com/en-us/azure/sentinel/billing-monitor-costs#deploy-a-workbook-to-visualize-data-ingestion</li> <li>Separate non-security data in a different workspace https://learn.microsoft.com/en-us/azure/sentinel/billing-reduce-costs#separate-non-security-data-in-a-different-workspace</li> <li>Optimize Log Analytics costs with dedicated clusters https://learn.microsoft.com/en-us/azure/sentinel/billing-reduce-costs#optimize-log-analytics-costs-with-dedicated-clusters</li> <li>Filter your logs before ingestion https://learn.microsoft.com/en-us/azure/sentinel/best-practices-data#filter-your-logs-before-ingestion</li> </ul> <p>Sentinel Free Data ingestion: always remember \"data collection\" is NOT detection!!</p> <ul> <li>Microsoft Sentinel benefit for Microsoft 365 E5 Customers https://azure.microsoft.com/en-us/offers/sentinel-microsoft-365-offer/</li> <li>Security Data Types inc. in 500Mb daily allowance https://docs.microsoft.com/en-us/azure/defender-for-cloud/enhanced-security-features-overview#what-data-types-are-included-in-the-500-mb-data-daily-allowance</li> <li>Cost Optimization tips from Rod Trent https://github.com/rod-trent/Azure-Sentinel-Cost-Troubleshooting-Kit<ul> <li>Managing Costs for Azure Monitor Logs </li> <li>Pricing Calculators</li> <li>KQL Queries</li> <li>Clive's Workspace Workbook</li> </ul> </li> </ul> <p>This recent addition below looks adventerous - but you might at least want to review the logic and have an alert sent to the team when you should be prompted to review or change the pricing tier? Don't forget to make sure the LAW is changed as well at the same time :)</p> <ul> <li>Automatically auto-scale your Sentinel pricing tiers: https://koosg.medium.com/auto-scale-your-sentinel-pricing-tiers-3d1f46b4c6ce</li> </ul> <p>The following table shows how Microsoft Sentinel and Log Analytics costs appear in the\u00a0Service name\u00a0and\u00a0Meter\u00a0columns of your Azure bill for free data services. For more information, see\u00a0View Data Allocation Benefits.</p> <p></p>"},{"location":"GSD/#sentinel-recommendation-to-enable-m365-defender-connector","title":"Sentinel - Recommendation to enable M365 Defender Connector","text":"<ul> <li>More information: https://docs.microsoft.com/en-us/azure/sentinel/microsoft-365-defender-sentinel-integration</li> </ul>"},{"location":"GSD/#troubleshooting_6","title":"Troubleshooting","text":"<ul> <li> <p>Troubleshoot your CEF or Syslog data connector</p> </li> <li> <p>Troubleshoot Jupyter notebooks</p> </li> <li> <p>Troubleshoot AWS S3 connector issues</p> </li> <li> <p>Troubleshooting your Microsoft Sentinel Solution for SAP deployment</p> </li> </ul>"},{"location":"GSD/#azure-log-management","title":"Azure Log Management","text":"<ul> <li> <p>Design a Log Analytics workspace architecture - Azure Monitor</p> </li> <li> <p>Workspace architecture best practices for Microsoft Sentinel</p> </li> <li> <p>Best practices for data collection in Microsoft Sentinel</p> </li> <li> <p>Incident creation rules that need to be mindful of to avoid creating multiple Incidents</p> </li> <li> <p>Bi-directional Sync between M365 Defender &amp; Sentinel</p> </li> </ul>"},{"location":"GSD/#8-microsoft-information-protection-mipaip","title":"8.   Microsoft Information Protection (MIP/AIP)","text":"<p>This page will also cover Data Loss Prevention (DLP), but we'll probably build out a whole new section on Purview as this site matures, thank you for your patience - please feel free to provide feedback via raising an issue in Github.</p> <p>First up - to a certain degree, you will find a lot of what you need here in the OSS page for \"Purview Customer Experience Engineering\" page - please start here: Microsoft Purview One-Stop-Shop (OSS) &lt;-- Start Here</p> <p>This site is very comprehensive, and should have most answers, and will add more later - but for now it saves reinventing the wheel </p> <p></p>"},{"location":"GSD/#9-asd-essential-8-now-acsc","title":"9.   ASD Essential 8 (now ACSC)","text":""},{"location":"GSD/#asd-essential-8-now-acsc","title":"ASD Essential 8 (now ACSC)","text":"<ul> <li>Great high level on all Essential 8 https://www.microsoft.com/en-au/business/topic/security/essential-eight/</li> <li>6 videos that walk thru https://info.microsoft.com/AU-SCRTY-CATALOG-FY21-02Feb-14-TheEssentialEightforSecurityinPractice-SRDEM61939_CatalogDisplayPage.html</li> <li>Microsoft Cybersecurity Reference Architecture  https://aka.ms/MCRA or https://learn.microsoft.com/en-us/security/cybersecurity-reference-architecture/mcra</li> <li>General on Essential 8 https://learn.microsoft.com/en-us/compliance/anz/e8-overview</li> <li>Daily backups https://learn.microsoft.com/en-us/compliance/anz/e8-backups</li> <li>Australian IRAP https://learn.microsoft.com/en-us/azure/compliance/offerings/offering-australia-irap &amp; https://servicetrust.microsoft.com/Viewpage/AustraliaIRAP</li> </ul> <p>Local Australian E8 Guides -   Microsoft Service Trust Portal has the local Essential 8 guides  https://aka.ms/e8guides here you will find the PDF's covering the following specifics - the guides below can be accessed easy enough, but you will need to sign in using your own Tenant ID to access the IRAP docs ;)</p> <ul> <li>Microsoft General - Essential Eight - Config Macros</li> <li>Microsoft General - Essential Eight - User Application Hardening</li> <li>Microsoft General - Essential Eight - Restricting Admin Priv</li> <li>Microsoft General - Essential Eight - Patch OS</li> <li>Microsoft General - Essential Eight - Backup</li> <li>Microsoft General - Essential Eight - Patch Applications</li> <li>Microsoft General - Essential Eight - MFA</li> </ul>"},{"location":"GSD/#hardening-guidance-from-acsc","title":"Hardening Guidance from ACSC","text":"<ul> <li>For Windows 10 21H1 https://www.cyber.gov.au/acsc/view-all-content/publications/hardening-microsoft-windows-10-version-21h1-workstations</li> <li>For Office https://www.cyber.gov.au/acsc/view-all-content/publications/hardening-microsoft-365-office-2021-office-2019-and-office-2016</li> <li>For Macro's https://www.cyber.gov.au/resources-business-and-government/maintaining-devices-and-systems/system-hardening-and-administration/system-hardening/restricting-microsoft-office-macros</li> <li>For Intune https://github.com/microsoft/Intune-ACSC-Windows-Hardening-Guidelines</li> <li>WDAC Policy creation from DTA https://desktop.gov.au/blueprint/abac/wdac-policy-creation.html</li> </ul>"},{"location":"GSD/#hardening-azure-ad","title":"Hardening Azure AD","text":"<ul> <li>Secure your Azure AD identity infrastructure - Azure Active Directory</li> <li>Also worth reviewing our Essential 8 guidance, especially MFA (aka.ms/e8guides)</li> <li>Microsoft Azure Identity Security Compass - Microsoft Security Best Practices</li> <li>Active Directory - Best Practices for Securing Active Directory</li> </ul>"},{"location":"GSD/#ad-onprem","title":"AD onPrem","text":"<p>A list of resources from DART perspective on Active Directory - courtesy of Matt Zorich (X @reprise99)</p> <ul> <li>BloodHound Edges https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html</li> <li>AD Security https://adsecurity.org/?page_id=4031</li> <li>iRed Team notes https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse...</li> <li>SID History Persistence https://adsecurity.org/?p=1772</li> <li>How AdminSdHolder &amp; SDProp work https://techcommunity.microsoft.com/t5/ask-the-directory-services-team/five-common-questions-about-adminsdholder-and-sdprop/ba-p/396293...</li> <li>Recovering from systemic identity compromise https://learn.microsoft.com/en-us/azure/security/fundamentals/recover-from-identity-compromise</li> <li>Abusing Active Directory ACLs/ACEs https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/acl-persistence-abuse...</li> <li>Defender for Identity Alerts Overview https://learn.microsoft.com/en-us/defender-for-identity/alerts-overview...</li> <li>Best practices for securing AD https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/best-practices-for-securing-active-directory</li> <li>Mimikatz DCSync Abuse https://adsecurity.org/?p=1729</li> <li>Kerberoasting Overview https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/t1208-kerberoasting...</li> <li>Monitoring AD for signs of compromise https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/monitoring-active-directory-for-signs-of-compromise</li> </ul>"},{"location":"GSD/#identity","title":"Identity","text":"<ul> <li>Best Practices https://learn.microsoft.com/en-us/security/compass/compass</li> <li>From Jeffrey Appel https://jeffreyappel.nl/tips-for-preventing-against-new-modern-identity-attacks-aitm-mfa-fatigue-prt-oauth/     look at Partner section</li> <li>MDCA (was MCAS) policies from AADIP P2 moving to D365 Console<ul> <li>https://learn.microsoft.com/en-us/microsoft-365/security/defender/microsoft-365-security-center-defender-cloud-apps?view=o365-worldwide&amp;WT.mc_id=AZ-MVP-5004291#control</li> <li>https://www.linkedin.com/posts/sami-lamppu_microsoft-defender-for-cloud-apps-in-microsoft-activity-7011278821773471744-TcvX?</li> </ul> </li> </ul>"},{"location":"GSD/#exchange-permissions-check","title":"Exchange Permissions check","text":"<p>These two are subtly different, the first is on mailboxes, the second is more focused on the Outlook Folders</p> <ul> <li>https://office365itpros.com/2020/03/16/exchange-online-mailbox-permissions/</li> <li>https://github.com/12Knocksinna/Office365itpros/blob/master/ReportMailboxPermissionsMailboxes.PS1</li> <li>https://office365itpros.com/2020/03/23/reporting-exchange-online-folder-permissions/</li> <li>https://github.com/12Knocksinna/Office365itpros/blob/master/ReportPermissionsFolderLevel.PS1</li> </ul>"},{"location":"GSD/#10-windows-defender-application-control-wdac","title":"10.   Windows Defender Application Control (WDAC)","text":"<p>Work in Progress, please review all content before starting, and be cautious in deployment</p> <ul> <li>From Eric Mannon: https://www.linkedin.com/feed/update/urn:li:activity:6996238396973051904/</li> <li>Read the above article first</li> <li>1st- Install WDACme on all W10 workstations</li> <li>2nd- Enable \"Smart Application Control\" in Evaluation mode on W11 endpoints that support it</li> <li>3rd- Lock down Tier 0 (DC's, ADFS &amp; AD Connect servers) with WDAC Microsoft-only mode in block mode. (No 3rd party software should ever be installed on the Tier 0 server type)</li> <li>4th- Deploy a supplemental policy to block the Microsoft recommended block list</li> <li>\ud83d\udd11Golden rule: \"Audit is better than nothing\"</li> <li>\ud83c\udfafDesired state: \"Zero Trust for unapproved code\"</li> </ul> <p>\ud83c\udf92Resources:</p> <ul> <li>WDAC Deployment: https://lnkd.in/em8sV9AK</li> <li>\u26c4\ufe0f Olaf Hartong's: WDACMe: https://lnkd.in/gU33rPzf</li> <li>W11 Smart App Control: https://lnkd.in/e5X3WF9H</li> <li>Recommended Block Rules: https://lnkd.in/eZEwcwM9</li> <li>WDAC Policy Wizard: https://lnkd.in/gwFuvmd4</li> <li>Hunting WDAC Events in KQL: https://lnkd.in/eJE8WHZG</li> </ul>"},{"location":"GSD/#additional-resources","title":"Additional Resources","text":"<ul> <li>Creating a policy for machines already in use (this is the hard one) https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/create-initial-default-policy#create-a-custom-base-policy-to-minimize-user-impact-on-in-use-client-devices</li> <li>WDAC Policy creation from DTA - https://desktop.gov.au/blueprint/abac/wdac-policy-creation.html</li> <li>https://www.cyber.gov.au/acsc/view-all-content/publications/implementing-application-control</li> <li>https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/create-wdac-deny-policy</li> <li>https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/deploying-windows-10-application-control-policy/ba-p/2486267</li> <li>https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/select-types-of-rules-to-create</li> <li>https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules</li> <li>https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control-deployment-guide</li> </ul>"},{"location":"GSD/#defender-for-business","title":"Defender for Business","text":"<ul> <li>Review the technical documentation\u00a0 https://aka.ms/MDB-Docs </li> <li>Review the Partner asset\u00a0 https://aka.ms/MDBPartnerKit </li> <li>Attend SMB Partner Webinars\u00a0 https://aka.ms/M365MDBSeries </li> <li>Join Office Hours\u00a0 https://aka.ms/MDB-Office-Hours </li> <li>Be aware of Lighthouse\u00a0 https://aka.ms/M365Lighthouse</li> </ul> <p>Updated Guides:\u00a0 -   Exchange Online to Business Premium -   Business Standard to Business Premium -   Business Basic to Business Premium</p> <p>Updated Microsoft 365 Business Premium\u00a0Customer Pitch Decks: -   Business Decision Maker Pitch Deck -   IT Decision Maker Pitch Deck\u00a0 -   Updated Webinar:\u00a0Having a customer conversation on security for Business\u00a0Premium upsell </p>"},{"location":"GSD/#ninja-security-training","title":"Ninja Security Training","text":"<ul> <li>M365 Defender : https://aka.ms/m365dninja</li> <li>Microsoft Defender for Endpoint: https://aka.ms/mdeninja</li> <li>Microsoft Defender for Identity : https://aka.ms/MDINinja</li> <li>Microsoft Defender for O365 : https://aka.ms/mdoninja</li> <li>Microsoft Defender for Cloud Apps: http://aka.ms/mcasninja (formerly MCAS)</li> <li>Microsoft Sentinel : https://aka.ms/sentinelninja</li> <li>Microsoft Sentinel for MSSP : http://aka.ms/azsentinelmssp</li> <li>Microsoft Defender for Cloud : http://aka.ms/ascninja</li> <li>Azure Network Security Ninja : http://aka.ms/aznetsecninja</li> <li>Microsoft Defender for IoT: https://aka.ms/d4iotninja</li> <li>Microsoft Purview Information Protection: https://aka.ms/mipninja </li> <li>Microsoft Purview DLP ninja: https://aka.ms/DLPNinja </li> <li>Microsoft Purview Insider Risk Management: https://aka.ms/insiderriskninja </li> <li>Microsoft Purview eDiscovery: https://aka.ms/ediscoveryninja </li> <li>Microsoft Purview Communication Compliance: https://aka.ms/communicationcomplianceninja</li> <li>Microsoft Purview Compliance Manager: http://aka.ms/compliancemanagerninja</li> <li>Sentinel Automation: https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/become-a-microsoft-sentinel-automation-ninja/ba-p/3563377</li> <li>Sentinel Notebooks: https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/becoming-a-microsoft-sentinel-notebooks-ninja-the-series/ba-p/2693491</li> <li>Microsoft Threat Intelligence: https://techcommunity.microsoft.com/t5/microsoft-defender-threat/become-a-microsoft-defender-threat-intelligence-ninja-the/ba-p/3656965</li> <li>Must Learn KQL: https://github.com/rod-trent/MustLearnKQL</li> <li>Kusto Detective Agency: https://detective.kusto.io</li> <li>Microsoft Defender for Endpoint Trial: https://aka.ms/mdetrial</li> <li>Exam SC-900: https://learn.microsoft.com/en-us/certifications/exams/sc-900</li> <li>Exam SC-200: https://learn.microsoft.com/en-us/certifications/exams/sc-200</li> </ul>"},{"location":"GSD/#interactive-guides","title":"Interactive Guides","text":"<ul> <li>Defender for Cloud</li> <li>Microsoft Sentinel</li> <li>M365 Defender</li> <li>M365 Defender - Threat Protection</li> <li>MCAS - Detect Threat and manage Alerts</li> <li>MCAS - Discover, protect and control your Apps</li> <li>MDE - Investigate Threats</li> <li>MDE - Investigate and Remediate Threats</li> <li>MDE - Reduce Risk</li> <li>MDE - Threat and Vulnerability Management</li> <li>MDI - Detect Suspicious Activities</li> <li>MDI - Investigate Suspicious Activities</li> <li>MDI - Investigate and Respond to Attacks</li> <li>MDO - Safeguard Email</li> <li>MDO - Enable Protection</li> <li>Purview Insider Risk Management</li> <li>Purview Communications Risk </li> <li>Purview Information Protection</li> <li>Purview Forensic investigation of Security events</li> <li>Purview eDiscovery</li> </ul> <p> (Still working on Tables)</p>"},{"location":"GSD/#product-trials","title":"Product Trials","text":"<ul> <li>Microsoft Defender for Identity</li> <li>Microsoft Defender for Office 365 P2</li> <li>Microsoft Defender for Endpoint P2</li> <li>Microsoft 365 E5 Security</li> <li>Microsoft Defender for IoT</li> <li>Microsoft Defender for Cloud Apps</li> <li>Microsoft Defender for Cloud Apps -- App Governance add-on</li> <li>Microsoft Sentinel</li> <li>Microsoft Defender for Office 365</li> <li>Microsoft Sentinel Labs</li> <li>Microsoft Defender for Endpoint P2</li> <li>Microsoft Purview Solutions</li> <li>Microsoft Purview Compliance Manager premium assessments</li> <li>Microsoft 365 E5 Insider Risk Management</li> <li>Microsoft 365 E5 Information Protection &amp; Governance</li> <li>Microsoft 365 E5 Compliance</li> <li>Microsoft Compliance Manager premium assessment</li> <li>Microsoft 365 E5 eDiscovery &amp; Audit</li> <li>Microsoft Priva</li> <li>Microsoft Priva Privacy Risk Management</li> <li>Microsoft Priva Subject Rights Requests</li> </ul>"},{"location":"GSD/#fasttrack","title":"FastTrack","text":"<ul> <li>FastTrack Core Deck: https://aka.ms/FastTrackCoreDeck</li> <li>FastTrack Benefit Description Deck: https://aka.ms/FastTrackBenefitDeck</li> <li>FastTrack Ready Partners: https://aka.ms/FastTrackReadyPartners</li> <li>FastTrack customer one-pager: https://aka.ms/FastTrackOnePager</li> </ul>"},{"location":"GSD/#microsoft-private-security-communities-nda","title":"Microsoft Private Security Communities (NDA)","text":"<p>If you want to keep up to date with the latest + connect with your peers from Microsoft, Partners and Customers this is an invaluable resource</p> <ul> <li> <p>Microsoft Cloud Security Private Community - https://aka.ms/prseccom</p> </li> <li> <p>Microsoft 365 Defender Customer Connection Program - https://aka.ms/M365DefenderCCPSignUp</p> </li> </ul> <p>Both of the Team Channels above are covered by your NDA with Microsoft from either a Partner or Customer perspective.</p> <p>+--------------------------------------------+--------------------------------+ | Microsoft Cloud Security Private         | Microsoft 365 Defender       | | Community                                | Customer Connection Program  | +============================================+================================+ |            |  | |  | g) | |                                     |                                | | \u00a0                                   | \u00a0                              | |                                     |                                | |                                     |   | |                                     |                                | |                                     |                                | |                                     | \u00a0                              | +-------------------------------------+--------------------------------+</p> <p>https://aka.ms/JoinCCP</p> <p>---This form is currently only used for Compliance &amp; Privacy Community requests---  - To join the Windows CCP visit https://aka.ms/JoinWCCP  - To join the M365 Defender CCP visit https://aka.ms/M365DefenderCCPSignUp  - To join the MEM CCP visit https://aka.ms/JoinMEMCCP  - To join the Compliance &amp; Privacy CCP visit https://aka.ms/JoinCompliancePrivacyCCP</p>"},{"location":"GSD/#for-partners","title":"For PARTNERS","text":"<ul> <li>Everything you wanted to know about Sentinel Architecture https://aka.ms/PartnerSocArchitecture</li> </ul> <p>All content listed will require Microsoft Partner login: i.e. use your work creds &amp; password this is already federated for you</p> <ul> <li> <p>MS Partner - go to https://cdx.transform.microsoft.com and get access to 5 x 90day demo Tenants for free + 1 for 1 year</p> <ul> <li>You will need to add Az Subs from either Pay-as-you-Go or MSDN for Items like Sentinel that require LAW, etc...</li> <li>Don't build it - Use a premade one - be aware that from the same location you can get access to CIE Demo tenants with additional pre-canned content for customer demos  (CIE = Customer Immersive Experiences)</li> <li>Don't waste time building demos \"unless\" the customer already has specific requirements</li> <li>Use this one below to access Contoso Hotels as a 3,000 seat Production demo hosted by Microsoft</li> <li>Search for or Choose \"Microsoft Sentinel &amp; Microsoft 365 Defender (SIEM &amp; XDR)\"</li> <li> <p>Add the Customer name and you will get access to the following + the Launch button will pop up with Partner Creds (good for     24h):</p> <ul> <li>SIEM &amp; XDR Demo scenario walkthrough recording (Heike Ritter - 59m)<ul> <li>SIEM &amp; XDR - CxE walks you through the new security operation demo based on the AiTM (Adversary in the Middle) phishing attack leveraging both Microsoft 365 Defender &amp; Microsoft Sentinel.</li> <li>Defender Security Console - https://security.microsoft.com/homepage?tid=4b2462a4-bbee-495a-a0e1-f23ae524cc9c</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>Partner: https://cloudpartners.transform.microsoft.com/</p> </li> <li>Security Workshops: https://cloudpartners.transform.microsoft.com/workshops?tab=security-usage</li> <li>Security Training: https://readiness.transform.microsoft.com/learning-paths/b7963402-e1ba-4485-8889-af04614e2d1b</li> <li>Build Intent Workshops: https://partner.microsoft.com/en-us/partnership/partner-incentives/modern-work-and-security-build-intent-workshops</li> </ul>"},{"location":"GSD/#build-intent-workshops","title":"Build Intent Workshops","text":"<ul> <li>Workshops Available: Partners can nominate Customers and receive USD $5K funding upon successful PoE submission</li> <li>Make sure you review the content below, it's typically very recent (within 6 months), and laid out very well in a structured manner with plenty of content in slide decks along with example SoW's &amp; estimate effort</li> <li>Full list of workshops below with direct links below the table</li> </ul> Sales Usage Defend Against Threats with SIEM Plus XDR Defend Against Threats with SIEM Plus XDR Executive Order 14028 (Zero Trust) Secure Identities and Access Mitigate Compliance and Privacy Risks Mitigate Compliance and Privacy Risks Protect and Govern Sensitive Data Protect and Govern Sensitive Data Secure Multi-Cloud Environments Secure Multi-Cloud Environments <p>Sales</p> <ul> <li> <p>Defend Against Threats with SIEM Plus XDR</p> </li> <li> <p>Executive Order 14028 (Zero Trust)</p> </li> <li> <p>Mitigate Compliance and Privacy Risks </p> </li> <li> <p>Protect and Govern Sensitive Data </p> </li> <li> <p>Secure Multi-Cloud Environments </p> </li> </ul> <p>Usage</p> <ul> <li> <p>Defend Against Threats with SIEM Plus XDR - Usage</p> </li> <li> <p>Secure Identities and Access - Usage</p> </li> <li> <p>Mitigate Compliance and Privacy Risks - Usage </p> </li> <li> <p>Protect and Govern Sensitive Data - Usage </p> </li> <li> <p>Secure Multi-Cloud Environments - Usage </p> </li> </ul> <p>Partner Incentives Overview:     https://partner.microsoft.com/en-se/partnership/partner-incentives/</p>"},{"location":"Guides/","title":"Security Interactive Guides & Product Trials","text":""},{"location":"Guides/#interactive-guides","title":"Interactive Guides","text":"<ul> <li>Defender for Cloud</li> <li>Microsoft Sentinel</li> <li>M365 Defender</li> <li>M365 Defender - Threat Protection</li> <li>MCAS - Detect Threat and manage Alerts</li> <li>MCAS - Discover, protect and control your Apps</li> <li>MDE - Investigate Threats</li> <li>MDE - Investigate and Remediate Threats</li> <li>MDE - Reduce Risk</li> <li>MDE - Threat and Vulnerability Management</li> <li>MDI - Detect Suspicious Activities</li> <li>MDI - Investigate Suspicious Activities</li> <li>MDI - Investigate and Respond to Attacks</li> <li>MDO - Safeguard Email</li> <li>MDO - Enable Protection</li> <li>Purview Insider Risk Management</li> <li>Purview Communications Risk </li> <li>Purview Information Protection</li> <li>Purview Forensic investigation of Security events</li> <li>Purview eDiscovery</li> </ul> <p> (Still working on getting tables working on web site, sorry)</p>"},{"location":"Guides/#product-trials","title":"Product Trials:","text":"<ul> <li>Microsoft Defender for Identity</li> <li>Microsoft Defender for Office 365 P2</li> <li>Microsoft Defender for Endpoint P2</li> <li>Microsoft 365 E5 Security</li> <li>Microsoft Defender for IoT</li> <li>Microsoft Defender for Cloud Apps</li> <li>Microsoft Defender for Cloud Apps -- App Governance add-on</li> <li>Microsoft Sentinel</li> <li>Microsoft Defender for Office 365</li> <li>Microsoft Sentinel Labs</li> <li>Microsoft Defender for Endpoint P2</li> <li>Microsoft Purview Solutions</li> <li>Microsoft Purview Compliance Manager premium assessments</li> <li>Microsoft 365 E5 Insider Risk Management</li> <li>Microsoft 365 E5 Information Protection &amp; Governance</li> <li>Microsoft 365 E5 Compliance</li> <li>Microsoft Compliance Manager premium assessment</li> <li>Microsoft 365 E5 eDiscovery &amp; Audit</li> <li>Microsoft Priva</li> <li>Microsoft Priva Privacy Risk Management</li> <li>Microsoft Priva Subject Rights Requests</li> </ul>"},{"location":"MDO/","title":"5. Microsoft Defender for Office (MDO)","text":"<ul> <li> <p>Features https://learn.microsoft.com/en-us/office365/servicedescriptions/microsoft-defender-for-office-365-features</p> </li> <li> <p>Understand how EOP works: https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/eop-about?view=o365-worldwide#how-eop-works </p> </li> <li> <p>Order and precedence of email protection https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/how-policies-and-protections-are-combined?view=o365-worldwide</p> </li> <li> <p>Appendix - It's important to understand how user allows and blocks, tenant allows and blocks, and filtering stack verdicts in EOP and Defender for Office 365 complement or contradict each other.  https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/how-policies-and-protections-are-combined?view=o365-worldwide#appendix</p> </li> </ul> <p>Recent BEC activity (Business Email Compromise) https://x.com/jhencinski/status/1616543412940931075?s=61&amp;t=C1HAZW3QfTIcWUDtZNoHOw</p> <p>Great NEW update on Automation https://www.techrepublic.com/article/microsoft-defender-365-automation-fight-automated-attacks/</p>"},{"location":"MDO/#ways-of-working","title":"Ways of working","text":"<ul> <li>Top 20 most-viewed admin help articles this month https://learn.microsoft.com/en-us/microsoft-365/admin/top-m365-admin-articles?view=o365-worldwide</li> <li>How to secure your business data with Microsoft 365 for business https://learn.microsoft.com/en-us/microsoft-365/admin/security-and-compliance/secure-your-business-data?view=o365-worldwide</li> <li>Basic authentication sign-in prompts are blocked by default in Microsoft 365 Apps https://learn.microsoft.com/en-us/deployoffice/security/basic-authentication-prompts-blocked</li> </ul>"},{"location":"MDO/#enable-telemetry","title":"Enable Telemetry","text":"<ul> <li> <p>Step-by-Step guide https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/step-by-step-guides/step-by-step-guide-overview</p> </li> <li> <p>Try in Audit mode https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/try-microsoft-defender-for-office-365</p> </li> <li> <p>Enhanced Filters aka Skip Listing (use for Migration) https://learn.microsoft.com/en-us/Exchange/mail-flow-best-practices/use-connectors-to-configure-mail-flow/enhanced-filtering-for-connectors Especially this last one on Enhanced Filters, this is where it is possible to enable MDO to co-exist with what ever 3rd party system you are using today, but it will typically require an MX record change, and is not an undertaking to be taken lightly. The main point - it is possible to have co-existense - but this should NOT be seen as a long term process!!   </p> </li> <li> <p>Data retention information for Microsoft Defender for Office 365 https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/mdo-data-retention?view=o365-worldwide</p> </li> </ul>"},{"location":"MDO/#validate-and-test","title":"Validate and Test","text":"<ul> <li>AIR - make sure you Enable this https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/office-365-air</li> <li> <p>How AIR works https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/office-365-air</p> </li> <li> <p>Integrate Microsoft Defender for Endpoint with Microsoft Defender for Cloud Apps https://learn.microsoft.com/en-us/defender-cloud-apps/mde-integration</p> </li> </ul>"},{"location":"MDO/#enable-reporting","title":"Enable Reporting","text":"<ul> <li> <p>Protect against Threats https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/protect-against-threats</p> </li> <li> <p>What is ZAP? Zero-hour auto purge (ZAP) in Exchange Online https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/zero-hour-auto-purge?view=o365-worldwide</p> </li> <li> <p>Alert Policies in Microsoft 365 https://learn.microsoft.com/en-us/microsoft-365/compliance/alert-policies?view=o365-worldwide</p> </li> <li> <p>Manage mailbox auditing https://learn.microsoft.com/en-us/microsoft-365/compliance/audit-mailboxes?view=o365-worldwide</p> </li> <li> <p>Audit log activities https://learn.microsoft.com/en-us/microsoft-365/compliance/audit-log-activities?view=o365-worldwide</p> </li> <li> <p>View dashboards and reports in the Microsoft 365 Defender portal https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/tenant-wide-setup-for-increased-security?view=o365-worldwide#view-dashboards-and-reports-in-the-microsoft-365-defender-portal</p> </li> </ul>"},{"location":"MDO/#review-and-improve-as-needed","title":"Review and Improve as needed","text":"<ul> <li> <p>The display of incident evidence for email and email clusters https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/email-analysis-investigations?view=o365-worldwide#the-display-of-incident-evidence-for-email-and-email-clusters</p> </li> <li> <p>Tune anti-phishing protection https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-phishing-protection-tuning?view=o365-worldwide</p> </li> <li> <p>Review and manage remediation actions in Office 365 https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/air-review-approve-pending-completed-actions?view=o365-worldwide</p> </li> <li> <p>Detect &amp; Address compromised user accounts with automated investigation and response https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/address-compromised-users-quickly?view=o365-worldwide</p> </li> <li> <p>Detect and Remediate Illicit Consent Grants https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/detect-and-remediate-illicit-consent-grants?view=o365-worldwide</p> </li> <li> <p>Detect &amp; Respond to a compromised connector https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/connectors-detect-respond-to-compromise?view=o365-worldwide</p> </li> <li> <p>Config Analyzer https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/configuration-analyzer-for-security-policies</p> </li> <li> <p>Recommended Settings https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/recommended-settings-for-eop-and-office365</p> </li> <li> <p>SecOps Guide https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/mdo-sec-ops-guide</p> </li> <li> <p>Macros from the internet will be blocked by default in Office https://learn.microsoft.com/en-us/deployoffice/security/internet-macros-blocked</p> </li> <li> <p>Trusted Locations for Office files https://learn.microsoft.com/en-us/deployoffice/security/trusted-locations </p> </li> </ul>"},{"location":"MDO/#troubleshooting","title":"Troubleshooting","text":"<ul> <li> <p>Troubleshooting mail sent to Microsoft 365 https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/mail-flow-troubleshooting?view=o365-worldwide</p> </li> <li> <p>Roles and role groups in Microsoft Defender for Office 365 and Microsoft Purview compliance https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/scc-permissions?view=o365-worldwide</p> </li> <li> <p>Monitor for leaks of personal data https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/monitor-for-leaks-of-personal-data?view=o365-worldwide </p> </li> <li> <p>Privileged Identity Management (PIM) and why to use it with Microsoft Defender for Office 365 https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/use-privileged-identity-management-in-defender-for-office-365?view=o365-worldwide</p> </li> <li> <p>Add support for anonymous inbound email over IPv6 in Microsoft 365 https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/mail-flow-inbound-ipv6-support-about?view=o365-worldwide</p> </li> </ul>"},{"location":"Identity/","title":"Top 5 Tips re: Identity","text":"<p>https://www.microsoft.com/en-us/security/blog/2023/01/09/microsoft-entra-5-identity-priorities-for-2023/ </p> <ul> <li> <p>from Matt Zorich - Total Identity Compromise: DART lessons on securing Active Directory https://techcommunity.microsoft.com/t5/microsoft-security-experts-blog/total-identity-compromise-dart-lessons-on-securing-active/ba-p/3753391</p> </li> <li> <p>from Matt Zorich - Incident Playbooks https://learn.microsoft.com/en-us/security/compass/incident-response-playbooks</p> </li> <li> <p>Azure Active Directory deployment plans https://learn.microsoft.com/en-us/azure/active-directory/fundamentals/active-directory-deployment-plans</p> </li> <li> <p>Azure AD - Attack and Defense Playbook https://github.com/Cloud-Architekt/AzureAD-Attack-Defense</p> </li> <li> <p>Enable LAPS on all devices https://techcommunity.microsoft.com/t5/microsoft-entra-azure-ad-blog/introducing-windows-local-administrator-password-solution-with/ba-p/1942487</p> </li> <li> <p>Identity Checklists  https://github.com/Azure/review-checklists</p> </li> <li> <p>What authentication and verification methods are available in Azure Active Directory? https://learn.microsoft.com/en-AU/azure/active-directory/authentication/concept-authentication-methods </p> </li> </ul>"},{"location":"Updates/","title":"Updates","text":"<p>Not everybody consumes info in the same way, but this is how I consume/manage the constant flow of info: -   Text, links and graphics (pptx and pdf preferably) so that I can skim FAST -   Others like Video, I find it too time consuming -   Plus I focus on searching for the great content &amp; then tracking the people that created that and build a network</p> <p>\u00b7 Infographic: #BeCyberSmart with Devices and Data \u00b7 Infographic: #BeCyberSmart with Phishing \u00b7 Infographic: #BeCyberSmart with Scams \u00b7 Infographic: #BeCyberSmart with Passwords \u00b7 Infographic: #BeCyberSmart with Cybersecurity 101 \u00b7 Email: #BeCyberSmart with best practices for your organization \u00b7 Video Series: Learn how to #BeCyberSmart with these video tips and tricks </p> <p>https://admin.microsoft.com/Adminportal/Home?Q=ADG#/SetupGuidance</p> <p>Change over to different way of Processing to add support for .git https://github.com/marketplace/actions/mkdocs-deployment And https://github.com/marketplace/actions/mkdocs-link-check</p> <p>Defender Threat Intel https://ti.defender.microsoft.com/</p> <p>MDO Config Analyzer https://Aka.ms/defenseindepth </p> <p>Insider Risk</p> <p>Discussions: https://github.com/dcaddick/gsd_public/discussions</p> <p>https://www.blimped.nl/managing-and-applying-purview-retention-labels-using-code/#conclusion</p> <p>check out other \"saved posts\" from LinkedIn https://www.linkedin.com/my-items/saved-posts/</p> <p>https://x.com/jeffreyappel7/status/1616196538337792009?s=61&amp;t=4qPz80pQqXdQmuvndvnOPw</p> <p>Automate from Outlook ToDo into Planner  https://make.preview.powerautomate.com/galleries/public/templates/67477f30373611e7870df906aa521b7a/create-planner-tasks-for-flagged-emails-in-office-365?fromflowportal=true&amp;environment=839eace6-59ab-4243-97ec-a5b8fcc104e4 </p> <p>Expand on SOAR as a separate Heading This covers M365 (think AIR) as well as Sentinel</p> <p>Expand on Private Communities?</p>"},{"location":"Updates/#ways-of-working","title":"Ways of working","text":""},{"location":"Updates/#enable-telemetry","title":"Enable Telemetry","text":""},{"location":"Updates/#validate-and-test","title":"Validate and Test","text":""},{"location":"Updates/#enable-reporting","title":"Enable Reporting","text":""},{"location":"Updates/#review-and-improve-as-needed","title":"Review and Improve as needed","text":""},{"location":"Updates/#troubleshooting","title":"Troubleshooting","text":"<p>Technical Legacy Debt -   Goal: Understand who owns the legacy environment -   Validate (again) if the legacy systems are actually required - absence of ownership is a good indicator that this platform may be considered for retirement -   Consider passing on the cost of additional controls and operations burden - if the PROBLEM of legacy systems never have an owner, then the problem will never get solved. \u00a0And even if the problem is managed, if there is no additional cost burden, then there is less motivation to actually solve (i.e. retire) the legacy platform problem. -   Use a scream test - shutdown legacy system and see who screams ;-) -   Goal: Reduce the exposure by limiting the access -   Move these systems to a controlled network environment - e.g. segregated network zone with firewalls to limit access - only allow the traffic absolutely essential for the legacy application -   Deploy extensive monitoring of these systems - with high severity alerts being generated -   Consider migrating these legacy systems off the production domain (goal is to reduce the legacy authentication protocols being run across the whole environment - perhaps they have their own segregated domain with constrained Trust relationships back to production) -   Consider Applocker as another compensating control - intent is to only allow the legacy app to run, and NOTHING ELSE -   Have limits and controls around remote access - MFA / jumphost etc - reduce the ability for non-authorised users to access these vulnerable systems</p>"},{"location":"MDCA/","title":"3. Microsoft Defender for Cloud Apps (MDCA)","text":""},{"location":"MDCA/#mdca-was-mcas","title":"MDCA (was MCAS)","text":""},{"location":"MDCA/#ways-of-working","title":"Ways of working","text":"<p>First decision point - Simple or Complex, i.e. do you need to be concerned about RBAC for instance becuase of the scale of the installation or the number of different parties that may need access to part or some parts of the console? https://learn.microsoft.com/en-us/defender-cloud-apps/manage-admins</p>"},{"location":"MDCA/#enable-telemetry","title":"Enable Telemetry","text":"<ul> <li>Basic Setup --&gt; Start here:</li> <li>https://learn.microsoft.com/en-us/defender-cloud-apps/general-setup</li> <li>https://learn.microsoft.com/en-us/defender-cloud-apps/get-started</li> <li>Tell MDCA what the Corporate IP address's are  https://learn.microsoft.com/en-us/defender-cloud-apps/ip-tags</li> <li>Set the IP's in bulk if needed https://learn.microsoft.com/en-us/defender-cloud-apps/api-data-enrichment-manage-script</li> <li>Enable File Monitoring https://learn.microsoft.com/en-us/defender-cloud-apps/file-filters</li> <li>Add native App Connectors (Atlassian, Google, Azure, AWS, Box, DocuSign, Github, Okta, Salesforce, ServiceNow, Slack, Workday, etc... ) https://learn.microsoft.com/en-us/defender-cloud-apps/enable-instant-visibility-protection-and-governance-actions-for-your-apps</li> <li>Best Practices https://learn.microsoft.com/en-us/defender-cloud-apps/best-practices</li> <li>Daily Activities https://learn.microsoft.com/en-us/defender-cloud-apps/daily-activities-to-protect-your-cloud-environment</li> </ul> <p>The best practices discussed in the link above include:</p> <ul> <li>Discover and assess cloud apps</li> <li>Apply cloud governance policies</li> <li>Limit exposure of shared data and enforce collaboration policies</li> <li>Discover, classify, label, and protect regulated and sensitive data stored in the cloud</li> <li>Enforce DLP and compliance policies for data stored in the cloud</li> <li>Block and protect download of sensitive data to unmanaged or risky devices</li> <li>Secure collaboration with external users by enforcing real-time session controls</li> <li>Detect cloud threats, compromised accounts, malicious insiders, and ransomware</li> <li>Use the audit trail of activities for forensic investigations</li> <li>Secure IaaS services and custom apps</li> </ul> <p>Warning</p> <ul> <li>For best protection, we recommend selecting all Office 365 components.</li> <li>The Office 365 files component, requires the Office 365 activities component and Defender for Cloud Apps file monitoring (Settings &gt; Files &gt; Enable file monitoring).</li> <li>Make sure the last checkbox (Office 365 Files) in the image below is \"checked\" link to more details </li> </ul> <p></p>"},{"location":"MDCA/#validate-and-test","title":"Validate and Test","text":"<ul> <li>Enable MDE Integration https://learn.microsoft.com/en-us/defender-cloud-apps/mde-integration </li> <li>Enable MDI Integration https://learn.microsoft.com/en-us/defender-cloud-apps/mdi-integration</li> <li>Govern discovered Apps using MDE (enables blocking of unwanted Apps) https://learn.microsoft.com/en-us/defender-cloud-apps/mde-govern</li> <li>Investigating via Dashboard https://learn.microsoft.com/en-us/defender-cloud-apps/investigate</li> <li>Tune the system  https://learn.microsoft.com/en-us/defender-cloud-apps/tutorial-suspicious-activity</li> <li>Investigate &amp; remediate risky OAuth Apps https://learn.microsoft.com/en-us/defender-cloud-apps/investigate-risky-oauth</li> </ul> <p>Note</p> <ul> <li>It takes up to two hours after you enable the integration for the data to show up in Defender for Cloud Apps.</li> <li>List of supported Firewalls and Proxies</li> <li>Follow link above for Integration steps with ZScaler, iboss, Menlo, etc...</li> </ul> <p></p>"},{"location":"MDCA/#enable-reporting","title":"Enable Reporting","text":"<ul> <li>Investigate Apps discovered by MDE  https://learn.microsoft.com/en-us/defender-cloud-apps/mde-investigation</li> <li>Governance for Connected Apps https://learn.microsoft.com/en-us/defender-cloud-apps/governance-actions This is where this process gets really good, have a real good look at all the possibilities here to be able to be able to track what is being done with data inside the environment - don't jump in &amp; start blocking things before you understand the full business implications. </li> <li>Governance for discovered Apps https://learn.microsoft.com/en-us/defender-cloud-apps/governance-discovery Now we can take this one step further and we can now determine which of the 26,000 SaaS Apps I want to allow or block - the only real limitation (to a certain extent) is that the user is using corporate credentials from our AAD via an endpoint enabled with MDE </li> </ul>"},{"location":"MDCA/#review-and-improve-as-needed","title":"Review and Improve as needed","text":"<ul> <li>Add Conditional Access App Control into the mix - this is where we are starting to get more into Zero Trust - so don't jump in here first, make sure the rest of the Security settings are in place and then come back to this in a later phase https://learn.microsoft.com/en-us/defender-cloud-apps/proxy-intro-aad</li> </ul> <p>There is a lot more to be covered, but this will do for now, if you have questions please let us know? https://github.com/dcaddick/gsd_public/discussions</p>"},{"location":"MDCA/#use-mdca-to-track-monitor-and-block-generative-ai-as-needed","title":"Use MDCA to track, monitor and block Generative AI as needed","text":"<p>To enable Defender for Cloud Apps to track Generative AI SaaS apps in your tenant, follow these steps:</p> <p>Discover Generative AI Apps:</p> <ul> <li>Microsoft Defender for Cloud Apps provides capabilities to discover and manage Generative AI apps. Start by gaining visibility into the Generative AI apps currently in use.</li> <li>The cloud app catalog now contains hundreds of new Generative AI apps that enable security teams to discover and understand the risk associated with each app.</li> </ul> <p>Setup Policies:</p> <ul> <li>Configure policies to automatically trigger alerts when new Generative AI apps are used within your organization.</li> <li>Create policy as per Blog article in link above</li> <li>For organizations using Defender for Endpoint integration, apps tagged as \u201cunsanctioned\u201d will be instantly blocked on onboarded devices.</li> </ul> <p>Monitor Usage:</p> <ul> <li>Regularly review the list of Generative AI apps in use.</li> <li>Leverage the Defender for Cloud Apps dashboard to track app activity and assess risk factors.</li> <li>Consider generating a Cloud Discovery executive report to identify top potential risks and plan workflows for risk mitigation</li> <li>Monitoring usage per person can be achieved in the console in the lower right hand side </li> </ul> <p>Microsoft Purview Integration:</p> <ul> <li>Combine the capabilities of Microsoft Purview with Microsoft Defender for comprehensive visibility.</li> <li>Gain insights into the usage of Generative AI apps, including sensitive data interactions and the total number of users interacting with AI</li> </ul> <p>Remember that Generative AI adoption is growing rapidly, and having effective visibility and control over these apps is crucial for maintaining security without disrupting productivity. By following these steps, you\u2019ll be better equipped to manage Generative AI apps in your tenant! \ud83d\ude80\ud83d\udd12</p> <p>For detailed documentation on each step, refer to the following links:</p> <ul> <li>Discover, monitor, and protect the use of Generative AI apps</li> <li>Working with discovered apps - Microsoft Defender for Cloud Apps</li> <li>Cloud app catalog and risk scores - Microsoft Defender for Cloud Apps</li> </ul> <p>For those who prefer a Video - check Andre's session here - Microsoft Defender for Cloud Apps - Why \"CASB\" and how it can help monitor and control ChatGPT usage </p> <p>I'll try and add some screenshots later...</p>"},{"location":"MDCA/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>Advanced Settings URL </li> <li>Troubleshooting</li> <li>Apps list</li> <li>Sanctioned/Unsanctioned</li> <li>Don't forget this is based on MDE so go back and check the MDE integration link above</li> </ul>"},{"location":"MIP/","title":"8. Microsoft Information Protection (MIP/AIP)","text":"<p>This page will also cover Data Loss Prevention (DLP), but we'll probably build out a whole new section on Purview as this site matures, thank you for your patience - please feel free to provide feedback via raising an issue in Github.</p> <p>First up - to a certain degree, you will find a lot of what you need here in the OSS page for \"Purview Customer Experience Engineering\" page - please start here: Microsoft Purview One-Stop-Shop (OSS) &lt;-- Start Here</p> <p>You might also note that it uses Material for MkDocs as well ;-)</p>"},{"location":"MIP/#ways-of-working","title":"Ways of working","text":"<ul> <li>Look to enable Insider Risk &amp; Communications compliance first</li> <li>This will identify specific use cases &amp; Business Value almost immediately</li> <li>These can then be used to flesh out the current risks and security challenges that need to be addressed ASAP</li> <li>Start using Adaptive Protection for DLP controls to address immediate needs and pivot from this quick start to flesh out additional use cases with Project Management</li> </ul>"},{"location":"MIP/#latest-update","title":"Latest update","text":"<ul> <li>MIP/AIP - https://techcommunity.microsoft.com/t5/security-compliance-and-identity/azure-information-protection-and-the-information-protection/ba-p/3671070</li> <li>Adaptive Protection (DLP rules based on Insider Risk)</li> <li>Login as GA (or eqiv.) - https://admin.microsoft.com/adminportal/home?Q=ADG#/modernonboarding/mipsetupguide</li> <li></li> <li>Docs - https://learn.microsoft.com/en-gb/microsoft-365/compliance/information-protection</li> <li>DLP - https://learn.microsoft.com/en-gb/microsoft-365/compliance/dlp-learn-about-dlp</li> <li>What's new - https://learn.microsoft.com/en-gb/microsoft-365/compliance/whats-new</li> </ul>"},{"location":"MIP/#naming-evolution-aipmipmpip","title":"Naming evolution - AIP/MIP/MPIP","text":"<p>Note that while some documentation still references \"Azure Information Protection\", management and usage of these capabilites from within the Azure Portal have been deprecated as of January 2023. Management of the Information Protection scanner's capability is now performed from within the Information protection scanner menu within the Purview Compliance portal but still requires the Azure Information Protection Unified Labeling Client. Click here for details on deployment of the Unified Labeling Client.</p> <p>The \"Microsoft Information Protection\" name, along with other compliance and unified data governance products, were updated in 2022 to include \"Purview\" name. As such it's now called \"Microsoft Purview Information Protection\". For additional updates to the renaming of our compliance products reference this blog post</p>"},{"location":"MIP/#dlp-products","title":"DLP products","text":"Product / Service Data Location Use case Microsoft Purview Data Loss Prevention Endpoints, M365 data locations, bridged Data Connector locations Provides DLP capabilities primarily for M365 locations (e.g. O365, OneDrive, Teams, Yammer, SharePoint, etc.), endpoints who have Microsoft Defender for Endpoint (MDE) onboarded,  as well as locations that have been bridged to Purview via the Data Connectors capability. Microsoft Purview Information Protection Scanner Endpoint locations isolated from M365 SaaS services Use of this scanner is typically used to scan on-premesis data locations such as a file shares that the MDE agent cannot be deployed on. Additionally, it can be used to deploy DLP policies for disconnected resources that are \"air-gapped\" or simply isolated from the M365 SaaS offerings. This requires a secondary server within the network segment. Using this scanner to provide DLP on cloud connected resources is redundant and requires more overhead to manage. Defender for Cloud Apps Microsoft and non-Microsoft cloud With the use of \"File Policies\" you can address DLP for data locations that include and extend beyond M3635. Note that deployment of MDE on endpoints is required for Defender for Cloud to function. <p>While MDE is the primary agent that supports most of our Microsoft Security and Compliance suite solutions, some customers may have an alternative Anti-virust/Anti-malware (AV/AM) solution and wish to run MDE in passive mode. When MDE is running in passive mode, ONLY AV/AM enforcement policies are disabled. Alerting for AV/AM, along with alerting and policy enforcement for all other Microsoft Security and Compliance solutiongs (DCA, MPIP, DLP, etc..) that leverage the MDE agent will not be affected.</p>"},{"location":"MIP/#ninja-security-training","title":"Ninja Security Training","text":"<ul> <li>MPIP Ninja Training : https://aka.ms/MIPNinja</li> </ul>"},{"location":"Ninja/","title":"Ninja Security Training Content","text":""},{"location":"Ninja/#ninja-security-training","title":"Ninja Security Training","text":"<ul> <li>M365 Defender : https://aka.ms/m365dninja</li> <li>Microsoft Defender for Endpoint: https://aka.ms/mdeninja</li> <li>Microsoft Defender for Identity : https://aka.ms/MDINinja</li> <li>Microsoft Defender for O365 : https://aka.ms/mdoninja</li> <li>Microsoft Defender for Cloud Apps: http://aka.ms/mcasninja (formerly MCAS)</li> <li>Microsoft Sentinel : https://aka.ms/sentinelninja</li> <li>Microsoft Sentinel for MSSP : http://aka.ms/azsentinelmssp</li> <li>Microsoft Defender for Cloud : http://aka.ms/ascninja</li> <li>Microsoft Defender Threat Intelligence : https://techcommunity.microsoft.com/t5/microsoft-defender-threat/become-a-microsoft-defender-threat-intelligence-ninja-the/ba-p/3656965</li> <li>Azure Network Security Ninja : http://aka.ms/aznetsecninja</li> <li>Microsoft Defender for IoT: https://aka.ms/d4iotninja</li> <li>Microsoft Purview Information Protection: https://aka.ms/mipninja </li> <li>Microsoft Purview DLP ninja: https://aka.ms/DLPNinja </li> <li>Microsoft Purview Insider Risk Management: https://aka.ms/insiderriskninja </li> <li>Microsoft Purview eDiscovery: https://aka.ms/ediscoveryninja </li> <li>Microsoft Purview Communication Compliance: https://aka.ms/communicationcomplianceninja</li> <li>Microsoft Purview Compliance Manager: http://aka.ms/compliancemanagerninja</li> <li>Sentinel Automation: https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/become-a-microsoft-sentinel-automation-ninja/ba-p/3563377</li> <li>Sentinel Notebooks: https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/becoming-a-microsoft-sentinel-notebooks-ninja-the-series/ba-p/2693491</li> <li>Must Learn KQL: https://github.com/rod-trent/MustLearnKQL</li> <li>Kusto Detective Agency: https://detective.kusto.io</li> <li>Microsoft Defender for Endpoint Trial: https://aka.ms/mdetrial</li> <li>Exam SC-900: https://learn.microsoft.com/en-us/certifications/exams/sc-900</li> <li>Exam SC-200: https://learn.microsoft.com/en-us/certifications/exams/sc-200</li> </ul>"},{"location":"ASD/","title":"9. ASD/ACSC Essential 8 & Hardening Guides","text":""},{"location":"ASD/#asd-essential-8-now-acsc","title":"ASD Essential 8 (now ACSC)","text":"<ul> <li> <p>Please start with this - ACSC Essential 8 \u2013 Health Report in Microsoft Sentinel https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/acsc-essential-8-health-report-in-microsoft-sentinel/ba-p/3755702 </p> </li> <li> <p>Great high level on all Essential 8 https://aka.ms/e8guides</p> </li> <li>Collection of Australian M365 content on Essential 8 https://m365maps.com/australia.htm</li> <li>6 videos that walk thru https://info.microsoft.com/AU-SCRTY-CATALOG-FY21-02Feb-14-TheEssentialEightforSecurityinPractice-SRDEM61939_CatalogDisplayPage.html</li> <li>Microsoft Cybersecurity Reference Architecture  https://aka.ms/MCRA or https://learn.microsoft.com/en-us/security/cybersecurity-reference-architecture/mcra</li> <li>General on Essential 8 https://learn.microsoft.com/en-us/compliance/anz/e8-overview</li> <li>Daily backups https://learn.microsoft.com/en-us/compliance/anz/e8-backups</li> <li>Australian IRAP https://learn.microsoft.com/en-us/azure/compliance/offerings/offering-australia-irap &amp; https://servicetrust.microsoft.com/Viewpage/AustraliaIRAP</li> <li>Implmenting Essential 8 with Microsoft tooling </li> </ul> <p>Local Australian E8 Guides -   Microsoft Service Trust Portal has the local Essential 8 guides  https://aka.ms/e8guides here you will find the documentations covering the following specifics (dated Aug 2023) </p> <ul> <li>Microsoft General - Essential Eight - Config Macros</li> <li>Microsoft General - Essential Eight - User Application Hardening</li> <li>Microsoft General - Essential Eight - Restricting Admin Priv</li> <li>Microsoft General - Essential Eight - Patch OS</li> <li>Microsoft General - Essential Eight - Backup</li> <li>Microsoft General - Essential Eight - Patch Applications </li> <li>Microsoft General - Essential Eight - MFA</li> </ul>"},{"location":"ASD/#hardening-guidance-from-acsc","title":"Hardening Guidance from ACSC","text":"<ul> <li>For Windows 10 21H1 https://www.cyber.gov.au/acsc/view-all-content/publications/hardening-microsoft-windows-10-version-21h1-workstations</li> <li>For Office https://www.cyber.gov.au/acsc/view-all-content/publications/hardening-microsoft-365-office-2021-office-2019-and-office-2016</li> <li> <p>For Macro's</p> <ul> <li>Restricting Microsoft Office Macros https://www.cyber.gov.au/resources-business-and-government/maintaining-devices-and-systems/system-hardening-and-administration/system-hardening/restricting-microsoft-office-macros &amp; </li> <li>Technical example: Configure macro settings https://www.cyber.gov.au/resources-business-and-government/essential-cyber-security/small-business-cyber-security/small-business-cloud-security-guide/technical-example-configure-macro-settings</li> </ul> </li> <li> <p>For Intune https://github.com/microsoft/Intune-ACSC-Windows-Hardening-Guidelines</p> </li> <li>WDAC Policy creation from DTA https://desktop.gov.au/blueprint/abac/wdac-policy-creation.html</li> </ul>"},{"location":"ASD/#hardening-azure-ad","title":"Hardening Azure AD","text":"<ul> <li>Secure your Azure AD identity infrastructure - Azure Active Directory</li> <li>Also worth reviewing our Essential 8 guidance, especially MFA (aka.ms/e8guides)</li> <li>Microsoft Azure Identity Security Compass - Microsoft Security Best Practices</li> <li>Active Directory - Best Practices for Securing Active Directory</li> </ul>"},{"location":"ASD/#ad-onprem","title":"AD onPrem","text":"<p>A list of resources from DART perspective on Active Directory - courtesy of Matt Zorich (X @reprise99)</p> <ul> <li>BloodHound Edges https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html</li> <li>AD Security https://adsecurity.org/?page_id=4031</li> <li>iRed Team notes https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse...</li> <li>SID History Persistence https://adsecurity.org/?p=1772</li> <li>How AdminSdHolder &amp; SDProp work https://techcommunity.microsoft.com/t5/ask-the-directory-services-team/five-common-questions-about-adminsdholder-and-sdprop/ba-p/396293...</li> <li>Recovering from systemic identity compromise https://learn.microsoft.com/en-us/azure/security/fundamentals/recover-from-identity-compromise</li> <li>Abusing Active Directory ACLs/ACEs https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/acl-persistence-abuse...</li> <li>Defender for Identity Alerts Overview https://learn.microsoft.com/en-us/defender-for-identity/alerts-overview...</li> <li>Best practices for securing AD https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/best-practices-for-securing-active-directory</li> <li>Mimikatz DCSync Abuse https://adsecurity.org/?p=1729</li> <li>Kerberoasting Overview https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/t1208-kerberoasting...</li> <li>Monitoring AD for signs of compromise https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/monitoring-active-directory-for-signs-of-compromise</li> </ul>"},{"location":"ASD/#identity","title":"Identity","text":"<ul> <li>Best Practices https://learn.microsoft.com/en-us/security/compass/compass</li> <li>From Jeffrey Appel https://jeffreyappel.nl/tips-for-preventing-against-new-modern-identity-attacks-aitm-mfa-fatigue-prt-oauth/     look at Partner section</li> <li>MDCA (was MCAS) policies from AADIP P2 moving to D365 Console<ul> <li>https://learn.microsoft.com/en-us/microsoft-365/security/defender/microsoft-365-security-center-defender-cloud-apps?view=o365-worldwide&amp;WT.mc_id=AZ-MVP-5004291#control</li> <li>https://www.linkedin.com/posts/sami-lamppu_microsoft-defender-for-cloud-apps-in-microsoft-activity-7011278821773471744-TcvX?</li> </ul> </li> </ul>"},{"location":"ASD/#exchange-permissions-check","title":"Exchange Permissions check","text":"<p>These two are subtly different, the first is on mailboxes, the second is more focused on the Outlook Folders</p> <ul> <li>https://office365itpros.com/2020/03/16/exchange-online-mailbox-permissions/</li> <li>https://github.com/12Knocksinna/Office365itpros/blob/master/ReportMailboxPermissionsMailboxes.PS1</li> <li>https://office365itpros.com/2020/03/23/reporting-exchange-online-folder-permissions/</li> <li>https://github.com/12Knocksinna/Office365itpros/blob/master/ReportPermissionsFolderLevel.PS1</li> </ul>"},{"location":"AssumedKnowledge/","title":"Assumed Knowledge","text":""},{"location":"AssumedKnowledge/#assumed-knowledge","title":"Assumed Knowledge","text":"<p>This project is intended to remove friction to \"getting shit done\" and as such there is a certain amount of \"assumed knowledge\" that you are already somewhat experienced with the Microsoft Defender Security Suite of tools - in particular the 4 main pillars of MDI, MDE, MDO and MDCA (was MCAS) - if not then please consider having a good review of the Core Reference material below.</p> <p>However, if you've already got a reasonably good handle on this, don't let us stop you - dive straight in and \"get shit done\" ;-)</p> <p></p>"},{"location":"AssumedKnowledge/#assumed-licensing","title":"Assumed Licensing","text":"<p>ALL of this content is assuming that your M365 Tenant is at FULL E5 including Security and Compliance.</p> <p>For official details on how our Microsoft security and compliance services are provisioned, who benefits from these services and what licensing is required reference the following: - Microsoft 365 guidance for Security &amp; Compliance</p> <p>For unofficial details regarding M365 Features and Licensing reference the following guide: - Feature Matrix | M365 Maps </p> <p>If you need further assistance in Licensing please contact your local Microsoft Sales rep and start from there.  Apologies, but this content is focused and aimed at helping people get the solutions deployed.</p>"},{"location":"AssumedKnowledge/#core-reference-material","title":"Core reference material","text":""},{"location":"AssumedKnowledge/#latest-ciso-workshop-training","title":"Latest CISO Workshop Training","text":"<p>The Chief Information Security Officer (CISO) Workshop Training </p> <ul> <li>Microsoft Cybersecurity Reference Architecture -- https://aka.ms/MCRA - Direct link </li> <li>Security collateral inc. CISO Workshops, and lots more -- https://aka.ms/MarksList<ul> <li>Please - if you haven't come across these two links above before now - feel free to go and review and come back after and pick up here when done.</li> </ul> </li> </ul> <p>Please make sure you review the MCRA slide deck &amp; slide 15 - all of the slide is hyperlinked to other additional useful info - so have a good browse first and then if you have further questions on these 4 solution areas it might be worth reviewing the Ninja Training section?</p> <p></p>"},{"location":"AssumedKnowledge/#ninja-security-training","title":"Ninja Security Training","text":"<p>Subset here of the core pillars:</p> <ul> <li>M365 Defender : https://aka.ms/m365dninja</li> <li>Microsoft Defender for Endpoint: https://aka.ms/mdeninja</li> <li>Microsoft Defender for Identity : https://aka.ms/MDINinja</li> <li>Microsoft Defender for O365 : https://aka.ms/mdoninja</li> <li>Microsoft Defender for Cloud Apps: http://aka.ms/mcasninja (formerly MCAS)</li> <li>More at Ninja Security Training</li> </ul>"},{"location":"Author/","title":"Author, Contriburors &amp; Reviewers","text":""},{"location":"Author/#about","title":"About","text":"<p>GSD is my personal collection of Notes and Links regarding getting various aspects of Defender Security platform deployed, this is something that I was collecting in OneNote as I come across good content so that I can have it \"all in one place\" for ready reference later.</p> <p>While I work for Microsoft Australia I curate this content in my free time, so it should goe without saying that this is not official Microsoft material. This site will contain some visual representations of the various products &amp; will frequently reference Microsoft's own online documentation as well as occassionaly some partner-facing resources. This site does not represent Microsoft, and no warranty is given or implied. You should always work with your Microsoft account team or authorised reseller if you have any questions or concerns.</p> <p>I try to carefully balance the level of detail to ensure all the important solutions and features are accounted for, but not every feature is present and after all this content is a work in progress ;-) and will be updated on a regular basis. Please note there will always be gaps! If you see something missing and believe it should be there please contact me and I will do my best to add it. Please fee free to raise an Issue via Github.</p> <p>Any and all feedback is greatly appreciated!</p>"},{"location":"Author/#authors","title":"Authors","text":"<p>David Caddick I admit it's my fault \ud83d\ude06, as I started collecting all the useful links that I had in OneNote from the last 5 years of helping Microsoft Partners grow their Security business, as well as some of the great content that was now coming across my desk here in Microsoft - it just seemed to make sense to get it out of OneNote and into somewhere more accessible to help reduce friction for Customers and Partners wanting to get stuff done. Works for Microsoft as Senior Security Specialist, Perth Western Australia</p> <ul> <li>GitHub: https://github.com/dcaddick/</li> <li>X: https://x.com/dcaddick</li> <li>LinkedIn: https://linkedin.com/in/dcaddick/</li> </ul> <p>Martin Caddick Works for oobe in Canberra and absolute gun at Automating Markdown - thanks for the help in getting started on MkDocs in GitHub</p> <ul> <li>GitHub: https://github.com/martincaddick/</li> <li>LinkedIn: https://www.linkedin.com/in/martin-caddick-60065b1/</li> </ul> <p>Jos\u00e9 L\u00e1zaro Pinos Thanks for reviewing and providing feedback and advice Works for Microsoft as Partner Security Solution Architect, London UK</p> <ul> <li>LinkedIn: https://linkedin.com/in/jose365/</li> </ul>"},{"location":"Author/#feedback","title":"Feedback","text":"<ul> <li>Please feel free to submit Feedback, Issues or requests to be added here ;-)</li> <li>Please raise issues here: - https://github.com/dcaddick/gsd_public/issues</li> <li>Feel free to comment in discussions: - https://github.com/dcaddick/gsd_public/discussions</li> </ul>"},{"location":"Sentinel/","title":"7. Microsoft Sentinel Content","text":""},{"location":"Sentinel/#sentinel-tips-from-the-field","title":"Sentinel Tips from the Field","text":"<p>You want SOAR?</p> <ul> <li>Most folks skip Defender in preference for Sentinel...  </li> <li>Start from the desired outcome and work your way back from there</li> <li>What is it that SecOps need? - more automation, less manual work ;-)</li> <li>What does that look like? Showcase an example from Contoso Hotels</li> <li>Enable Automated Investigation &amp; Remediation (AIR) at MDI, MDO, MDE and M365 Defender console levels - don't skip this! - as this enables SOAR \"at source\"</li> <li>Now that we have the first level triage in place, let's now move on to Sentinel...</li> </ul>"},{"location":"Sentinel/#ways-of-working","title":"Ways of working","text":"<ul> <li>Raw logs by their very nature have a significant cost related to \"data gravity\" - the more Customers move/copy the logs the more complex the environment as well as more expensive the solution becomes - the design principle that should be recommend is to adhere to the MS Best Practices as much as possible.     https://learn.microsoft.com/en-us/azure/sentinel/best-practices-data</li> <li>Should there be any business justification or requirement for \"raw logs\" please consider a much more efficient method is the ability to stream \"advanced hunting\" events</li> <li>Please make sure that any request from SecOps for anything more than Alerts/Incidents (like request for raw data) is balanced against cost via Business Case Justification</li> <li>Why ingest or duplicate massive data sets across multiple systems based on a \"just in case\" scenario</li> <li>A much more efficient system would be to define the \"advanced hunting\" event that is being searched for and as and when matches are discovered the event is forwarded</li> <li>This process will respect data gravity and reduce costs significantly</li> <li>More information can be found here: Advanced hunting event collection</li> </ul>"},{"location":"Sentinel/#reducing-ttr","title":"Reducing TTR","text":"<ul> <li> <p>General recommendation is for Customers to focus efforts on increasing efficiency and reducing TTR (time to remediate) via Automation &amp; SOAR natively within Microsoft Sentinel will naturally improve C3 (SecOps) efficiency without the need for any additional tools.</p> <ul> <li>More information:</li> <li>CISO series: Lessons learned from the Microsoft SOC---Part 3a: Choosing SOC tools</li> <li>CISO series: Lessons learned from the Microsoft SOC---Part 3b: A day in the life</li> <li>CISO Series: Lessons learned from the Microsoft SOC---Part 3c: A day in the life part 2</li> </ul> </li> <li> <p>Focus on bringing all source logging relevant to the Users Device into the one location where it can be corelated quickly and seamlessly into a SOAR process to reduce friction and improve TTR times for SecOps</p> </li> <li>More information https://docs.microsoft.com/en-us/azure/sentinel/microsoft-365-defender-sentinel-integration</li> </ul>"},{"location":"Sentinel/#enable-telemetry","title":"Enable Telemetry","text":"<ul> <li>Best practices for Microsoft Sentinel https://learn.microsoft.com/en-us/azure/sentinel/best-practices</li> <li>Best practices for designing a Microsoft Sentinel or Azure Defender for Cloud workspace https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/best-practices-for-designing-a-microsoft-sentinel-or-azure/ba-p/832574</li> <li>Extend Microsoft Sentinel across workspaces and tenants https://learn.microsoft.com/en-us/azure/sentinel/extend-sentinel-across-workspaces-tenants</li> <li>Microsoft Sentinel workspace architecture best practices https://learn.microsoft.com/en-us/azure/sentinel/best-practices-workspace-architecture</li> </ul>"},{"location":"Sentinel/#validate-and-test","title":"Validate and Test","text":"<ul> <li> <p>How to Generate Microsoft Sentinel Incidents for Testing and Demos https://rodtrent.substack.com/p/how-to-generate-microsoft-sentinel</p> </li> <li> <p>Microsoft Sentinel \u2014 Testing detection rules like a Ninja https://rogierdijkman.medium.com/microsoft-sentinel-testing-detection-rules-like-a-ninja-cac612944dd1</p> </li> <li> <p>Learning with the Microsoft Sentinel Training Lab https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/learning-with-the-microsoft-sentinel-training-lab/ba-p/2953403</p> </li> </ul>"},{"location":"Sentinel/#enable-reporting","title":"Enable Reporting","text":"<ul> <li> <p>Tutorial: Create a Power BI report from Microsoft Sentinel data https://learn.microsoft.com/en-us/azure/sentinel/powerbi</p> </li> <li> <p>Investigate incidents with Microsoft Sentinel https://learn.microsoft.com/en-us/azure/sentinel/investigate-cases </p> </li> <li> <p>Automatically create incidents from Microsoft security alerts https://learn.microsoft.com/en-us/azure/sentinel/create-incidents-from-alerts</p> </li> </ul>"},{"location":"Sentinel/#review-and-improve-as-needed","title":"Review and Improve as needed","text":"<ul> <li>Need to migrate from your old SIEM? https://learn.microsoft.com/en-us/azure/sentinel/migration</li> </ul>"},{"location":"Sentinel/#filtering-logs","title":"Filtering Logs","text":"<p>Can be used to reduce data noise, reduce ingestion and retention/storage costs with the goal being to focus on the logs and events that are relevant - This is typically performed by one of the methods for the following scenarios:</p> <ul> <li> <p>Server Log Ingestion - Azure Monitor Agent Directly can filter out logs that are not relevant for Microsoft Sentinel     https://docs.microsoft.com/en-us/azure/sentinel/best-practices-data#filter-your-logs-before-ingestion</p> </li> <li> <p>Syslog and CEF Ingestion -- Using a log forwarder such as Logstash can parse the logs based on Customers defined rules    https://docs.microsoft.com/en-us/azure/sentinel/best-practices-data#filter-your-logs-before-ingestion</p> </li> <li> <p>Custom REST API Ingestion -- Via the Function or Logic App, data can be stripped away prior to sending to Microsoft sentinel - please see following two links    https://learn.microsoft.com/en-us/azure/sentinel/data-transformation https://learn.microsoft.com/en-us/azure/sentinel/configure-data-transformation</p> </li> </ul>"},{"location":"Sentinel/#cost-optimization","title":"Cost Optimization","text":"<ul> <li>Who knew? right ;) everyone  who has installed this finds it's too expensive?</li> <li>It's actually not - IF you're diligent and methodical about how you care and look after your Sentinel deployment AFTER it's deployed</li> <li>Almost like any piece of software - it needs to have an SDLC approach - once deployed (and indeed, every time you add another Data Connector) set a calendar reminder to go back and review costs/storage/trends a month later - exactly </li> <li> <p>Here's some other tips...</p> </li> <li> <p>Free data sources https://learn.microsoft.com/en-us/azure/sentinel/billing?tabs=free-data-meters#free-data-sources</p> </li> <li>View costs by using cost analysis https://learn.microsoft.com/en-us/azure/sentinel/billing-monitor-costs#view-costs-by-using-cost-analysis</li> <li>Run KQL queries to understand your data ingestion https://learn.microsoft.com/en-us/azure/sentinel/billing-monitor-costs#run-queries-to-understand-your-data-ingestion</li> <li>Deploy a workbook to visualize data ingestion https://learn.microsoft.com/en-us/azure/sentinel/billing-monitor-costs#deploy-a-workbook-to-visualize-data-ingestion</li> <li>Separate non-security data in a different workspace https://learn.microsoft.com/en-us/azure/sentinel/billing-reduce-costs#separate-non-security-data-in-a-different-workspace</li> <li>Optimize Log Analytics costs with dedicated clusters https://learn.microsoft.com/en-us/azure/sentinel/billing-reduce-costs#optimize-log-analytics-costs-with-dedicated-clusters</li> <li>Filter your logs before ingestion https://learn.microsoft.com/en-us/azure/sentinel/best-practices-data#filter-your-logs-before-ingestion</li> </ul> <p>Sentinel Free Data ingestion: always remember \"data collection\" is NOT detection!!</p> <ul> <li>Microsoft Sentinel benefit for Microsoft 365 E5 Customers https://azure.microsoft.com/en-us/offers/sentinel-microsoft-365-offer/</li> <li>Security Data Types inc. in 500Mb daily allowance https://docs.microsoft.com/en-us/azure/defender-for-cloud/enhanced-security-features-overview#what-data-types-are-included-in-the-500-mb-data-daily-allowance</li> <li>Cost Optimization tips from Rod Trent https://github.com/rod-trent/Azure-Sentinel-Cost-Troubleshooting-Kit<ul> <li>Managing Costs for Azure Monitor Logs </li> <li>Pricing Calculators</li> <li>KQL Queries</li> <li>Clive's Workspace Workbook</li> </ul> </li> </ul> <p>This recent addition below looks adventerous - but you might at least want to review the logic and have an alert sent to the team when you should be prompted to review or change the pricing tier? Don't forget to make sure the LAW is changed as well at the same time :)</p> <ul> <li>Automatically auto-scale your Sentinel pricing tiers: https://koosg.medium.com/auto-scale-your-sentinel-pricing-tiers-3d1f46b4c6ce</li> </ul> <p>The following table shows how Microsoft Sentinel and Log Analytics costs appear in the\u00a0Service name\u00a0and\u00a0Meter\u00a0columns of your Azure bill for free data services. For more information, see\u00a0View Data Allocation Benefits.</p> <p></p>"},{"location":"Sentinel/#sentinel-recommendation-to-enable-m365-defender-connector","title":"Sentinel - Recommendation to enable M365 Defender Connector","text":"<ul> <li>More information: https://docs.microsoft.com/en-us/azure/sentinel/microsoft-365-defender-sentinel-integration</li> </ul>"},{"location":"Sentinel/#troubleshooting","title":"Troubleshooting","text":"<ul> <li> <p>Troubleshoot your CEF or Syslog data connector</p> </li> <li> <p>Troubleshoot Jupyter notebooks</p> </li> <li> <p>Troubleshoot AWS S3 connector issues</p> </li> <li> <p>Troubleshooting your Microsoft Sentinel Solution for SAP deployment</p> </li> </ul>"},{"location":"Sentinel/#azure-log-management","title":"Azure Log Management","text":"<ul> <li> <p>Design a Log Analytics workspace architecture - Azure Monitor</p> </li> <li> <p>Workspace architecture best practices for Microsoft Sentinel</p> </li> <li> <p>Best practices for data collection in Microsoft Sentinel</p> </li> <li> <p>Incident creation rules that need to be mindful of to avoid creating multiple Incidents</p> </li> <li> <p>Bi-directional Sync between M365 Defender &amp; Sentinel</p> </li> </ul>"},{"location":"WDAC/","title":"10. Windows Defender App Control (WDAC)","text":""},{"location":"WDAC/#10-wdac-windows-defender-application-control","title":"10.   WDAC: (Windows Defender Application Control)","text":"<p>Danger</p> <p>Work in Progress, please review all content before starting, and be cautious in deployment Start in Test/UAT and avoid outliers like Developers Documentation on this page is very light at the moment and needs more review</p> <p>Troubleshooting: -   https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/operations/wdac-debugging-and-troubleshooting</p> <p>From Eric Mannon:  -   https://www.linkedin.com/feed/update/urn:li:activity:6996238396973051904/ -   Read the above article first -   1st- Install WDACme on all W10 workstations -   2nd- Enable \"Smart Application Control\" in Evaluation mode on W11 endpoints that support it -   3rd- Lock down Tier 0 (DC's, ADFS &amp; AD Connect servers) with WDAC Microsoft-only mode in block mode. (No 3rd party software should ever be installed on the Tier 0 server type) -   4th- Deploy a supplemental policy to block the Microsoft recommended block list -   \ud83d\udd11Golden rule: \"Audit is better than nothing\" -   \ud83c\udfafDesired state: \"Zero Trust for unapproved code\"</p> <p>\ud83c\udf92Resources:</p> <ul> <li>WDAC Deployment: https://lnkd.in/em8sV9AK</li> <li>\u26c4\ufe0f Olaf Hartong's: WDACMe: https://lnkd.in/gU33rPzf</li> <li>W11 Smart App Control: https://lnkd.in/e5X3WF9H</li> <li>Recommended Block Rules: https://lnkd.in/eZEwcwM9</li> <li>WDAC Policy Wizard: https://lnkd.in/gwFuvmd4</li> <li>Hunting WDAC Events in KQL: https://lnkd.in/eJE8WHZG</li> </ul>"},{"location":"WDAC/#deeper-background","title":"Deeper Background","text":"<ul> <li>For those that want a deeper background on how this works, warning this is quite a big rabbit hole</li> <li>https://medium.com/falconforce/sysmon-vs-microsoft-defender-for-endpoint-mde-internals-0x01-1e5663b10347</li> <li>https://medium.com/falconforce/microsoft-defender-for-endpoint-internals-0x02-audit-settings-and-telemetry-1d0af3ebfb27</li> <li>https://medium.com/falconforce/microsoft-defender-for-endpoint-internals-0x03-mde-telemetry-unreliability-and-log-augmentation-ec6e7e5f406f</li> <li>https://medium.com/falconforce/microsoft-defender-for-endpoint-internals-0x04-timeline-3f01282839e4</li> </ul>"},{"location":"WDAC/#additional-resources","title":"Additional Resources","text":"<ul> <li>Creating a policy for machines already in use (this is the hard one) https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/create-initial-default-policy#create-a-custom-base-policy-to-minimize-user-impact-on-in-use-client-devices</li> <li>WDAC Policy creation from DTA - https://desktop.gov.au/blueprint/abac/wdac-policy-creation.html</li> <li>https://www.cyber.gov.au/acsc/view-all-content/publications/implementing-application-control</li> <li>https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/create-wdac-deny-policy</li> <li>https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/deploying-windows-10-application-control-policy/ba-p/2486267</li> <li>https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/select-types-of-rules-to-create</li> <li>https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/microsoft-recommended-block-rules</li> <li>https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-application-control/windows-defender-application-control-deployment-guide</li> </ul>"},{"location":"MDE/","title":"4. Microsoft Defender for Endpoint (MDE)","text":""},{"location":"MDE/#mde-microsoft-defender-for-endpoint","title":"MDE (Microsoft Defender for Endpoint)","text":""},{"location":"MDE/#ways-of-working","title":"Ways of working","text":"<p>Defender for Endpoint is for Endpoints, Servers actually belong in \"Defender for Cloud\": https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/migrating-mde-server-to-cloud</p> <ul> <li> <p>Architecture PDF https://download.microsoft.com/download/5/6/0/5609001f-b8ae-412f-89eb-643976f6b79c/mde-deployment-strategy.pdf</p> </li> <li> <p>Plan your deployement https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/deployment-strategy?view=o365-worldwide</p> </li> <li> <p>MDE Deployment overview https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/deployment-phases?view=o365-worldwide</p> </li> <li> <p>Phase 1 - Prepare Link</p> <ul> <li>Stakeholders and approval</li> <li>Environment</li> <li>RBAC</li> <li>Adoption Order</li> </ul> </li> <li> <p>Phase 2 - Setup Link</p> <ul> <li>Check License state</li> <li>CSP Validation</li> <li>Tenant Config</li> <li>Data Centre location</li> <li>Network Config</li> </ul> </li> <li> <p>Phase 3 - Onbaording Link</p> <ul> <li>Onboarding &amp; Config</li> <li>Deployment Rings</li> <li>Using Config Manager</li> <li>Using MEM</li> </ul> </li> </ul> <p></p>"},{"location":"MDE/#enable-telemetry","title":"Enable Telemetry","text":"<ul> <li> <p>Onbarding &amp; Configuration https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/onboarding-endpoint-manager?view=o365-worldwide</p> </li> <li> <p>Configure Device Discovery https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-device-discovery</p> </li> <li>Check it's working --&gt; using Simulated Attacks https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-simulations</li> <li>Automation Levels https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/automation-levels?</li> <li>Configure AIR capabilities https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-automated-investigations-remediation</li> <li>Attack Surface Reduction (ASR) rules https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction</li> <li> <p>ASR Rules Deployment https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-deployment</p> </li> <li> <p>Attack surface reduction (ASR) rules report https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-report?</p> </li> </ul>"},{"location":"MDE/#validate-and-test","title":"Validate and Test","text":"<ul> <li>Scenarios &amp; Features listed with links to testing https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/defender-endpoint-demonstrations</li> <li>Block at First Sight - test/demo https://demo.wd.microsoft.com/Page/BAFS</li> <li>Demonstrate &amp; Test security controls: ASR, SmartScreen, PUA, etc...  https://demo.wd.microsoft.com/</li> </ul>"},{"location":"MDE/#migration","title":"Migration","text":"<ul> <li> <p>Migration Guide https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/migration-guides?</p> </li> <li> <p>Migrate to MDE from non-Microsoft endpoint protection https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/switch-to-mde-overview?</p> </li> <li> <p>Manage Microsoft Defender for Endpoint after initial setup or migration https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/manage-mde-post-migration?</p> </li> </ul>"},{"location":"MDE/#enable-reporting","title":"Enable Reporting","text":"<p>Consider consolidating All reporting below into Workbooks in Sentinel, this can typically be provided by a Partner, part of an MSSP process, or you can roll your own?</p> <ul> <li> <p>Device health reports in MDE https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/device-health-reports?</p> </li> <li> <p>Manage MDE Devices with MEM https://learn.microsoft.com/en-us/mem/intune/protect/mde-security-integration</p> </li> <li> <p>Fix unhealthy sensors in MDE https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/fix-unhealthy-sensors?</p> </li> <li> <p>Host firewall reporting in MDE https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/host-firewall-reporting?view=o365-worldwide</p> </li> <li> <p>MDE PowerBI https://github.com/microsoft/MicrosoftDefenderForEndpoint-PowerBI</p> </li> <li> <p>PowerShell scripts using MDE public API https://github.com/microsoft/MicrosoftDefenderATP-API-PowerShell</p> </li> <li> <p>MDE Advanced Hunting (AH) sample queries https://github.com/microsoft/WindowsDefenderATP-Hunting-Queries</p> </li> <li> <p>Python scripts using MDE public API https://github.com/microsoft/MicrosoftDefenderATP-API-Python</p> </li> </ul>"},{"location":"MDE/#review-and-improve-as-needed","title":"Review and Improve as needed","text":"<ul> <li> <p>Consider enabling Block at First Sight from AV: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-block-at-first-sight-microsoft-defender-antivirus</p> </li> <li> <p>Linux Advanced Guidance: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/comprehensive-guidance-on-linux-deployment</p> </li> </ul>"},{"location":"MDE/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>Troubleshooting: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/check-sensor-status</li> <li>Troubleshooting mode for devices: https://jeffreyappel.nl/microsoft-defender-for-endpoint-troubleshooting-mode-how-to-use-it/</li> <li>Migration Guide: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/migration-guides</li> </ul>"},{"location":"MDE/#m365-rbac","title":"M365 RBAC","text":"<p>Released late Dec 2022</p> <ul> <li>Shortcut to RBAC Permissions https://security.microsoft.com/mtp_roles</li> <li>Compare RBAC Roles https://learn.microsoft.com/en-us/microsoft-365/security/defender/compare-rbac-roles?</li> <li>Edit and Delete Roles https://learn.microsoft.com/en-us/microsoft-365/security/defender/edit-delete-rbac-roles? </li> </ul>"},{"location":"MDE/#mde-using-asr-stand-alone-e3","title":"MDE using ASR stand-alone (E3)","text":"<p>Handy tips and shortcuts for those that might still be trying to improve based on M365 E3 Licensing - apologies but this is not my focus, but when I do come across useful tips and links I'll add here:</p> <ul> <li>https://www.computerworld.com/article/3604651/decoding-windows-defender-s-hidden-settings.html</li> <li>https://github.com/AndyFul/ConfigureDefender</li> <li>https://www.defenderui.com/</li> <li>https://github.com/beerisgood/Windows11_Hardening</li> <li>https://jeffreyappel.nl/microsoft-defender-for-endpoint-series-define-the-av-baseline-part4a/</li> </ul>"},{"location":"MDC/","title":"6. Microsoft Defender for Cloud (MDC)","text":""},{"location":"MDC/#mdc-microsoft-defender-for-cloud","title":"MDC (Microsoft Defender for Cloud)","text":""},{"location":"MDC/#ways-of-working","title":"Ways of working","text":"<ul> <li> <p>Defender for Cloud Labs, great resource to get started and familiar https://github.com/Azure/Microsoft-Defender-for-Cloud/tree/main/Labs</p> </li> <li> <p>Deploying and Managing Microsoft Defender for Cloud as Code https://techcommunity.microsoft.com/t5/microsoft-defender-for-cloud/deploying-and-managing-microsoft-defender-for-cloud-as-code/ba-p/3649653</p> </li> <li> <p>How to deploy MDC at scale - PDF https://onedrive.live.com/?authkey=%21AIzlpf%2DTsBYFMbk&amp;cid=66C31D2DBF8E0F71&amp;id=66C31D2DBF8E0F71%212663&amp;parId=66C31D2DBF8E0F71%212662&amp;o=OneUp</p> </li> <li> <p>How to deploy MDC at scale - Video https://www.youtube.com/watch?v=o9wHIS_QLJE</p> </li> <li> <p>Use Azure Policies to drive each area as you progress      (work smarter, not harder)</p> <ul> <li> <p>Use the following policies to enable the particular Defender for Cloud plans (links below are for your Azure portal):  </p> </li> <li> <p>Configure Azure Defender for servers to be enabled </p> </li> <li>Configure Azure Defender for SQL servers on machines to be enabled </li> <li>Configure Azure Defender for Azure SQL database to be enabled </li> <li>Configure Azure Defender for Storage to be enabled </li> <li>Configure Azure Defender for App Service to be enabled </li> <li>Configure Azure Defender for DNS to be enabled </li> <li>Configure Azure Defender for Key Vaults to be enabled </li> <li>Configure Azure Defender for open-source relational databases to be enabled </li> <li>Configure Azure Defender for Resource Manager to be enabled</li> </ul> </li> </ul>"},{"location":"MDC/#enable-telemetry","title":"Enable Telemetry","text":"<ul> <li> <p>How to Effectively Perform a Microsoft Defender for Cloud PoC (updated March 2022) https://techcommunity.microsoft.com/t5/microsoft-defender-for-cloud/how-to-effectively-perform-a-microsoft-defender-for-cloud-poc/ba-p/516874</p> </li> <li> <p>Microsoft Defender for Cloud Lab http://aka.ms/MDFCLabs</p> </li> <li> <p>Quickstart: Enable enhanced security features https://learn.microsoft.com/en-us/azure/defender-for-cloud/enable-enhanced-security </p> </li> </ul>"},{"location":"MDC/#validate-and-test","title":"Validate and Test","text":"<ul> <li> <p>Alert validation in Microsoft Defender for Cloud https://learn.microsoft.com/en-us/azure/defender-for-cloud/alert-validation </p> </li> <li> <p>Simulate Alerts in Azure VM's, Linux VM's and Kubernates https://learn.microsoft.com/en-us/azure/defender-for-cloud/alert-validation#simulate-alerts-on-your-azure-vms-windows-</p> </li> <li> <p>How to validate Azure Key Vault Threat Detection alerts https://techcommunity.microsoft.com/t5/microsoft-defender-for-cloud/validating-azure-key-vault-threat-detection-in-microsoft/ba-p/1220336</p> </li> <li> <p>Trigger a test alert for Microsoft Defender for Storage https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-storage-test</p> </li> </ul>"},{"location":"MDC/#enable-reporting","title":"Enable Reporting","text":"<ul> <li> <p>Tutorial: Improve your regulatory compliance https://learn.microsoft.com/en-us/azure/defender-for-cloud/regulatory-compliance-dashboard</p> </li> <li> <p>Microsoft Defender for Cloud threat intelligence report https://learn.microsoft.com/en-us/azure/defender-for-cloud/threat-intelligence-reports</p> </li> </ul>"},{"location":"MDC/#review-and-improve-as-needed","title":"Review and Improve as needed","text":"<ul> <li> <p>Security posture for Microsoft Defender for Cloud https://learn.microsoft.com/en-us/azure/defender-for-cloud/secure-score-security-controls </p> </li> <li> <p>Implement security recommendations in Microsoft Defender for Cloud https://learn.microsoft.com/en-us/azure/defender-for-cloud/implement-security-recommendations</p> </li> <li> <p>Find recommendations that can improve your security posture https://learn.microsoft.com/en-us/azure/defender-for-cloud/review-security-recommendations</p> </li> </ul>"},{"location":"MDC/#troubleshooting","title":"Troubleshooting","text":"<ul> <li> <p>MDC Troubleshooting Guide https://learn.microsoft.com/en-us/azure/defender-for-cloud/troubleshooting-guide </p> </li> <li> <p>Don't forget the Community at Github: https://github.com/Azure/Microsoft-Defender-for-Cloud</p> <ul> <li>Labs to help you get started in deployment: https://github.com/Azure/Microsoft-Defender-for-Cloud/tree/main/Labs</li> <li>Onboarding: https://github.com/Azure/Microsoft-Defender-for-Cloud/tree/main/Onboarding</li> <li>Policy: https://github.com/Azure/Microsoft-Defender-for-Cloud/tree/main/Policy</li> <li>Powershell Scripts: https://github.com/Azure/Microsoft-Defender-for-Cloud/tree/main/Powershell%20scripts</li> <li>Simulations (check it's working): https://github.com/Azure/Microsoft-Defender-for-Cloud/tree/main/Simulations</li> <li>Workbooks: https://github.com/Azure/Microsoft-Defender-for-Cloud/tree/main/Workbooks</li> <li>Workflow Automation: https://github.com/Azure/Microsoft-Defender-for-Cloud/tree/main/Workflow%20automation</li> </ul> </li> <li> <p>Defender for Cloud Communitity Repository https://github.com/Azure/Microsoft-Defender-for-Cloud</p> </li> <li> <p>MDC Click thru Demo https://microsofteur.sharepoint.com/:p:/t/SecurityDemos/ERgIJG3yFCZJqyPbRa0KCa8BJYNZ-7UfwEMunKiUtuSIGg?e=c2wP4K</p> </li> </ul>"},{"location":"partner/","title":"Partner Content","text":""},{"location":"partner/#partner-only-content","title":"Partner only Content","text":"All content listed here will require Microsoft Partner login <p>i.e. use your Partner creds &amp; password as this content/site is already federated for you IF your organization     is a Microsoft Security Partner</p>"},{"location":"partner/#partner-enablement","title":"Partner Enablement","text":"<p>Get the latest up to date on Security, Compliance and Identity Management http://aka.ms/scipartnerenablement</p> <ul> <li>Get your storage for free as well Just a reminder to those that weren't aware, you can get an entirely free Azure Data Explorer cluster - &lt;http://aka.ms/kustofree. You get 100gb of storage, no credit card or anything required. I still use my free cluster all the time as a lab, it's a great learning environment.</li> </ul>"},{"location":"partner/#demo-tenants-5-x-free-for-90-days-ea","title":"Demo tenants = 5 x free for 90 days ea.","text":"<p>MS Partner - go to https://cdx.transform.microsoft.com and get access to 5 x 90 day demo Tenants for free + 1 for 1 year</p> <ul> <li>You will need to add Az Subs from either Pay-as-you-Go or MSDN for Items like Sentinel that require LAW, etc...</li> <li>Don't build it - Use a premade one - be aware that from the same location you can get access to CIE Demo tenants with additional pre-canned content for customer demos  (CIE = Customer Immersive Experiences)</li> <li>Don't waste time building demos \"unless\" the customer already has specific requirements</li> <li>Use this one below to access Contoso Hotels as a 3,000 seat Production demo hosted by Microsoft</li> <li>Search under \"Experiences\" for or Choose \"Microsoft Sentinel &amp; Microsoft 365 Defender (SIEM &amp; XDR)\"</li> <li> <p>Add the Customer name and you will get access to the following + the Launch button will pop up with Partner Creds (good for 24h):</p> <ul> <li>SIEM &amp; XDR Demo scenario walkthrough recording (Heike Ritter - 59m)</li> <li>SIEM &amp; XDR - CxE walks you through the new security operation demo based on the AiTM (Adversary in the Middle) phishing attack leveraging both Microsoft 365 Defender &amp; Microsoft Sentinel.</li> <li>Defender Security Console - https://security.microsoft.com/homepage?tid=4b2462a4-bbee-495a-a0e1-f23ae524cc9c</li> </ul> </li> <li> <p>Partner: https://cloudpartners.transform.microsoft.com/</p> </li> <li>Security Workshops: https://cloudpartners.transform.microsoft.com/workshops?tab=security-usage</li> <li>Security Training: https://readiness.transform.microsoft.com/learning-paths/b7963402-e1ba-4485-8889-af04614e2d1b</li> <li>Build Intent Workshops: https://partner.microsoft.com/en-us/partnership/partner-incentives/modern-work-and-security-build-intent-workshops</li> </ul>"},{"location":"partner/#build-intent-workshops","title":"Build Intent Workshops","text":"<ul> <li>Workshops Available: Partners can nominate Customers and receive USD $5K funding upon successful PoE submission</li> <li>Make sure you review the content below, it's typically very recent (within 6 months), and laid out very well in a structured manner with plenty of content in slide decks along with example SoW's &amp; estimate effort</li> <li>Full list of workshops below with direct links below the table</li> </ul> Sales Usage Defend Against Threats with SIEM Plus XDR Defend Against Threats with SIEM Plus XDR Executive Order 14028 (Zero Trust) Secure Identities and Access Mitigate Compliance and Privacy Risks Mitigate Compliance and Privacy Risks Protect and Govern Sensitive Data Protect and Govern Sensitive Data Secure Multi-Cloud Environments Secure Multi-Cloud Environments <p>Sales</p> <ul> <li> <p>Defend Against Threats with SIEM Plus XDR</p> </li> <li> <p>Executive Order 14028 (Zero Trust)</p> </li> <li> <p>Mitigate Compliance and Privacy Risks </p> </li> <li> <p>Protect and Govern Sensitive Data </p> </li> <li> <p>Secure Multi-Cloud Environments </p> </li> </ul> <p>Usage</p> <ul> <li> <p>Defend Against Threats with SIEM Plus XDR - Usage</p> </li> <li> <p>Secure Identities and Access - Usage</p> </li> <li> <p>Mitigate Compliance and Privacy Risks - Usage </p> </li> <li> <p>Protect and Govern Sensitive Data - Usage </p> </li> <li> <p>Secure Multi-Cloud Environments - Usage </p> </li> </ul> <p>Partner Incentives Overview:     https://partner.microsoft.com/en-se/partnership/partner-incentives/</p>"},{"location":"partner/#licensing-information","title":"Licensing information","text":"<ul> <li>Evergreen PDF for our Modern Work and Security product licensing matrix</li> </ul>"},{"location":"","title":"Get Security Done","text":"<p>aka.ms/gsd</p>"},{"location":"#feedback","title":"Feedback","text":"<ul> <li>Please feel free to submit Feedback, Issues or requests to be added here ;-)</li> <li>Please raise issues here: - https://github.com/dcaddick/gsd_public/issues</li> <li>Feel free to comment in discussions: - https://github.com/dcaddick/gsd_public/discussions</li> </ul> <p>Tip</p> <p>Use the search bar - it's surprisingly good - </p>"},{"location":"#current-state","title":"Current state","text":"<p>I have been focusing on the Microsoft Defender Security suite of tools &amp; growing the Security business for MS Partners based on the Microsoft Security platform for the last 5+ years or so.</p> <p>Over the years I have reviewed quite a few tenancies and a (not so) surprising trend has been that over 80+% have only ever turned on the first 10 - 15% of the config - so this leaves a BIG gap between what organizations think is protected and the reality.</p> <p>This something that really needs to change - that's what this site is about. Remove friction and empower customers and partners to cracking on getting things done. </p>"},{"location":"#inspiration","title":"Inspiration","text":"<p>Inspired by Mark Simos\u2019s Mark\u2019s List and a discussion after an \u201cIn to the Breach\u201d training exercise over a few beers it was discussed that there should be a local version focused more around \u201cGetting Security Done\u201d (hence the short link to GSD) with a specific focus on the M365 Security platform, but not restricted to just that as we'd like to adopt a very customer centric view point on this. (of course here in Australia we might typically refer to this as Get Shit Done - hence the GSD acronym)</p> <p>Into the Breach &amp; Shadow Hunter Great training experience to get a taste of what a fully configured Defender 365 or Defender for Cloud Security stack is capable off from a SecOps perspective</p>"},{"location":"#general-format-ways-of-working","title":"General format &amp; ways of working","text":"<p>For least friction and best outcome for the effort, start with enabling telemetry and visibility, and work your way from there in each Solution - so with that being said the intention (and eventual aim) is for each page to have the following sections. </p> <p>Please work thru these from top to bottom:</p> <ul> <li>Enable Telemetry</li> <li>Validate via Alerts</li> <li>Enable Reporting</li> <li>Step up Security Controls</li> <li>Troubleshooting  </li> </ul> <p>As you might have guessed by now, this is no small undertaking, so please bear with us while this gets built out. In the meantime we will continue to share any handy tips and tricks to reduce friction for those of you at the Deployment \"coal face\"</p>"},{"location":"#work-in-progress","title":"Work in Progress","text":"<p>So with that, planning got under way to create aka.ms/GSD, and of course we could always refer to this as Global Security Deployment? Please be aware this should always be considered a \"work in progress\" and will be updated as we go.</p> <p>Please note this will be a mix of both Microsoft &amp; non-Microsoft content, if it is of value and can help you with said mission of GSD for Security in the Microsoft Platform, then we'd like to include it - having said that, please feel free to provide feedback on the good, the bad and the ugly as we'd like to improve this over time.</p> <p>The full page that started all this can be found here GSD doc</p>"},{"location":"#still-to-do","title":"Still to do","text":"<ul> <li> Get plugins working, date updated, contributors, etc...</li> <li> Link in announcement to discussion board</li> <li> update About</li> <li> Fix Tables</li> <li> Fix images</li> <li> Assumed Knowledge</li> <li> Assumed Licenses</li> <li> Acronym Table?</li> <li> Short paragraph on each heading - Preview at top or separate tab?</li> <li> ToC/Index</li> <li> Add new Theme - https://github.com/byrnereese/mkdocs-bootstrap4  ???</li> <li> Shadow Hunter &amp; In to the Breach - Immersive workshops for SecOps</li> <li> Zero Trust - https://techcommunity.microsoft.com/t5/core-infrastructure-and-security/creating-mfa-policies-with-zero-trust-advanced-deployment-guide/ba-p/3688849</li> <li> CISA recommendations?</li> <li> Purview Insider Risk</li> <li> Purview in general</li> </ul> <p>What else needs doing?</p> <ul> <li>Please feel free to submit Feedback, Issues or requests to be added here ;-)</li> <li>Please raise issues here: - https://github.com/dcaddick/gsd_public/issues</li> <li>Feel free to comment in discussions: - https://github.com/dcaddick/gsd_public/discussions</li> </ul>"},{"location":"#how-was-this-site-created","title":"How was this site created","text":"<p>From MkDocs &amp; Material:</p> <ul> <li>MkDocs</li> <li>Github Actions Marketplace = MkDocs</li> <li>mkdocs-simple-plugin</li> <li>Material theme</li> </ul> <p>Key takeway - no need to touch Docker, Linux or Python, just let a plugin do the heavy lifting for you</p>"},{"location":"MDI/","title":"1. Microsoft Defender for Identity (MDI)","text":""},{"location":"MDI/#ways-of-working","title":"Ways of working","text":"<p>First decision point - do you have ANY Domain Controllers within your environment? If so then you should install MDI NOW and make it the very top of your Security ToDo list.</p> <p>Examples of WHY you do this first:</p> <ul> <li>Small Customer in 2018, back when this was called \"Azure ATP\", installed only as a PoC and in under 48 hours it had identified a mis-configured Server that was exposed to the internet and was being brute-forced via RDP from Eastern Europe.</li> <li>Larger environment 2020, client not sure but was wanting to lock down Legacy Auth, suggested that as they had E5 strong recommendation to deploy MDI ASAP across DC's. After getting CAB Approval to deploy, and with less than 10% coverage of DC's in just over a week it popped up with \"NTDIS Exfil via SMB\"</li> <li>Security Value = Priceless</li> </ul>"},{"location":"MDI/#latest-updates","title":"Latest Updates","text":"<p>(Thanks @fabian_bader)</p> <ul> <li>Automatic Attack Disruption at machine speed https://techcommunity.microsoft.com/t5/microsoft-365-defender-blog/what-s-new-in-xdr-at-microsoft-ignite/ba-p/3648872</li> <li>Microsoft Defender for Identity now detects suspicious certificate usage https://techcommunity.microsoft.com/t5/security-compliance-and-identity/microsoft-defender-for-identity-now-detects-suspicious/ba-p/3743335</li> <li>Read the full list here: https://learn.microsoft.com/en-us/defender-for-identity/whats-new#defender-for-identity-release-2198</li> </ul>"},{"location":"MDI/#enable-telemetry","title":"Enable Telemetry","text":"<p>Updated starting point: https://learn.microsoft.com/en-us/defender-for-identity/quick-installation-guide https://learn.microsoft.com/en-us/defender-for-identity/deploy-defender-identity</p> <p>Start here: https://learn.microsoft.com/en-us/defender-for-identity/prerequisites 1.  Capacity planning https://learn.microsoft.com/en-us/defender-for-identity/capacity-planning 2.   Download the Sizing tool https://github.com/microsoft/ATA-AATP-Sizing-Tool/releases 3.   Service account recommendations https://learn.microsoft.com/en-us/defender-for-identity/directory-service-accounts 4.   Download the Sensor https://learn.microsoft.com/en-us/defender-for-identity/download-sensor 5.   Install the Sensor on DC's https://learn.microsoft.com/en-us/defender-for-identity/install-sensor 6.   Basic Settings that you should review NOW https://www.microsoft.com/videoplayer/embed/RWFVEX</p> <p>This will do for now, especially if you are in a crisis mode, check the console for the DC's being online - now move on to validation below. Please follow up with all other Configuration steps as soon as practible, especially if you also have ADFS in play. </p> <p>For ADFS please also check - https://learn.microsoft.com/en-us/defender-for-identity/active-directory-federation-services</p>"},{"location":"MDI/#validate-and-test","title":"Validate and Test","text":"<p>Make sure you have the appropriate access to start with, if you have Admin rights to this tool you should see this once you have navigated to https://security.microsoft.com and selected &gt; Settings &gt; Identities &gt; first step is to check the Sensors are deployed on ALL DC's </p> <p>The most common error is \"Directory Services Object Auditing is not configured as required\" - this can be fixed by following instructions at: https://aka.ms/mdi/objectauditing </p> <p>Be conscious that if you are testing that MDI is working correctly that this may trigger high impact Alerts to your Blue Team or existing SecOps IF it's already installed and being monitored - or for that matter if another tooling is in place to monitor the same behaviour - so if doing some major testing it's worthwhile letting them know before hand?</p> <p>And on that, make sure you schedule some time to review afterwards about what testing/alerting was created &amp; what was visible from a SecOps perspective? </p> <p>Warning</p> <p>If you are getting a Pen Test done at some stage - make sure the Pen Test activity does actually appear somewhere in your telemetry - it should, and if it doesn't then you don't actually have any coverage? MDI can and will do this for you</p> <p>This would be valuable lessons on effectiveness - even more so if there is missing alerts?? :( </p> <ul> <li>Specific Validation information - https://learn.microsoft.com/en-us/defender-for-identity/configure-sensor-settings#validate-installations</li> <li>Use Attack Simulations to validate MDI is installed correctly and Alerts are being surfaced accurately:     https://learn.microsoft.com/en-us/defender-for-identity/playbooks</li> <li>Use Labs for in depth checking: https://learn.microsoft.com/en-us/defender-for-identity/playbook-lab-overview</li> <li>https://learn.microsoft.com/en-us/defender-for-identity/playbook-domain-dominance</li> </ul>"},{"location":"MDI/#enable-reporting","title":"Enable Reporting","text":"<p>Once enabled you should now have a lot more visibility into the Security Posture of the onPrem environment - including the following:</p> <ul> <li>Domain controllers with Print Spooler service available</li> <li>Dormant entities in sensitive groups</li> <li>Entities exposing credentials in clear text</li> <li>Microsoft LAPS usage</li> <li>Legacy protocols usage</li> <li>Riskiest lateral movement paths (LMP)</li> <li>Unmonitored domain controllers</li> <li>Unsecure account attributes</li> <li>Unsecure domain configurations</li> <li>Unsecure Kerberos delegation</li> <li>Unsecure SID History attributes</li> <li>Weak cipher usage</li> </ul> <p>More details can be found here &amp; example below - https://learn.microsoft.com/en-us/defender-for-identity/security-assessment#assessment-reports </p>"},{"location":"MDI/#review-and-improve-as-needed","title":"Review and Improve as needed","text":"<ul> <li>Review Security Assessments to validate what potentially needs remediation: https://learn.microsoft.com/en-us/defender-for-identity/security-assessment#assessment-reports</li> <li>Full list of the 44 Alerts that are being checked on your behalf when fully deployed: https://learn.microsoft.com/en-us/defender-for-identity/alerts-overview</li> <li>If you do not use the default Administrator account (ideally have it disabled?) then please add it to the Honeytoken account list: https://learn.microsoft.com/en-us/defender-for-identity/entity-tags#honeytoken-tags</li> <li>MDI (Hardened Environment) Setup from the Cyberlorians - https://github.com/Cyberlorians/Articles/blob/main/MDI-Hardened.md</li> <li>Audit checking via Sentinel for MDI - https://thalpius.com/2022/12/14/microsoft-defender-for-identity-auditing-checker-using-sentinel</li> <li>Thalpius and all MDI https://thalpius.com/</li> </ul>"},{"location":"MDI/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>https://learn.microsoft.com/en-us/defender-for-identity/troubleshooting-known-issues</li> <li>https://learn.microsoft.com/en-us/defender-for-identity/troubleshooting-using-logs</li> </ul>"}]}